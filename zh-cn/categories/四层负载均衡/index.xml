<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>å››å±‚è´Ÿè½½å‡è¡¡ on Bo&#39;s Blog</title>
        <link>https://boxtsecond.github.io/zh-cn/categories/%E5%9B%9B%E5%B1%82%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/</link>
        <description>Recent content in å››å±‚è´Ÿè½½å‡è¡¡ on Bo&#39;s Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <lastBuildDate>Tue, 05 Sep 2023 20:52:03 +0800</lastBuildDate><atom:link href="https://boxtsecond.github.io/zh-cn/categories/%E5%9B%9B%E5%B1%82%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆå››ï¼‰å®æ“ DR æ¨¡å‹ã€Keepalived DR æ¨¡å‹çš„é«˜å¯ç”¨</title>
        <link>https://boxtsecond.github.io/zh-cn/dev/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA-lvs-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%9B%9B%E5%AE%9E%E6%93%8D-dr-%E6%A8%A1%E5%9E%8Bkeepalived-dr-%E6%A8%A1%E5%9E%8B%E7%9A%84%E9%AB%98%E5%8F%AF%E7%94%A8/</link>
        <pubDate>Tue, 05 Sep 2023 20:52:03 +0800</pubDate>
        
        <guid>https://boxtsecond.github.io/zh-cn/dev/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA-lvs-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%9B%9B%E5%AE%9E%E6%93%8D-dr-%E6%A8%A1%E5%9E%8Bkeepalived-dr-%E6%A8%A1%E5%9E%8B%E7%9A%84%E9%AB%98%E5%8F%AF%E7%94%A8/</guid>
        <description>&lt;p&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ç³»åˆ—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆä¸€ï¼‰NATã€FULLNAT æ¨¡å‹åŸç†
&lt;ul&gt;
&lt;li&gt;ä¸¤å°è®¡ç®—æœºå¦‚ä½•åœ¨äº’è”ç½‘ä¸­é€šä¿¡&lt;/li&gt;
&lt;li&gt;LVS è´Ÿè½½å‡è¡¡
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œæº IP åœ°å€ã€æˆ–Â ã€Œç›®æ ‡ IP åœ°å€ã€
&lt;ul&gt;
&lt;li&gt;NAT æ¨¡å¼&lt;/li&gt;
&lt;li&gt;FULLNAT æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆäºŒï¼‰DRã€TUN æ¨¡å‹åŸç†
&lt;ul&gt;
&lt;li&gt;LVS è´Ÿè½½å‡è¡¡
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œç›®æ ‡ MAC åœ°å€ã€
&lt;ul&gt;
&lt;li&gt;DR æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€šè¿‡äºŒæ¬¡å°è£…æ•°æ®åŒ…çš„ã€ŒIP æŠ¥æ–‡ã€
&lt;ul&gt;
&lt;li&gt;TUN æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆä¸‰ï¼‰å®æ“ NATã€TUNNEL æ¨¡å‹ã€æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆå››ï¼‰å®æ“ DR æ¨¡å‹ã€Keepalived DR æ¨¡å‹çš„é«˜å¯ç”¨
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ UCloud äº‘ä¸»æœºå®æ“å„ä¸ªæ¨¡å‹&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ Keepalived å®ç° LVS-DR çš„é«˜å¯ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;LVSï¼ˆLinux Virtual Serverï¼‰æ˜¯ä¸€ä¸ªè™šæ‹ŸæœåŠ¡å™¨é›†ç¾¤ç³»ç»Ÿã€‚å·¥ä½œåœ¨ OSI æ¨¡å‹çš„ä¼ è¾“å±‚ï¼Œå³å››å±‚è´Ÿè½½å‡è¡¡ã€‚LVS æœ¬èº«å®ç°äº† NATã€DRã€TUN æ¨¡å‹ï¼Œè¿™äº›æ¨¡å‹ä»…åšæ•°æ®åŒ…çš„è½¬å‘ï¼Œè€Œä¸ä¼šä¸å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œæˆæœ¬ä½æ•ˆç‡é«˜ã€‚FULLNAT åŸºäº NAT å®ç°ï¼ŒLVS æœ¬èº«ä¸æ”¯æŒï¼Œéœ€è¦é¢å¤–å¯¹å†…æ ¸æ‰“è¡¥ä¸åæ‰èƒ½ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æœ¬ç³»åˆ—æŒ‰ç…§è´Ÿè½½å‡è¡¡å™¨å¯¹æ•°æ®åŒ…çš„å¤„ç†æ–¹å¼åˆ†ç±»ï¼Œä»è®¡ç®—æœºé—´é€šä¿¡çš„è§’åº¦å‡ºå‘ï¼Œæµ…è°ˆ NATã€FULLNATã€DRã€TUN æ¨¡å‹çš„å®ç°åŸç†ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹å‰ä»‹ç»äº† LVS è´Ÿè½½å‡è¡¡ NATã€FULLNATã€DRã€TUN æ¨¡å‹çš„å®ç°åŸç†ã€‚ç°åœ¨æ¥åŠ¨æ‰‹å®è·µä¸€ä¸‹ï½&lt;/p&gt;
&lt;h2 id=&#34;å®éªŒç¯å¢ƒ&#34;&gt;å®éªŒç¯å¢ƒ&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;LVS ç›®å‰å·²ç»æ˜¯ Linux å†…æ ¸ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨å†…æ ¸ä¸­çš„æ¨¡å—å«åš ipvsï¼Œæ”¯æŒ NATã€DRã€TUNNEL æ¨¡å‹ã€‚ç”¨æˆ·ä¸èƒ½ç›´æ¥æ“ä½œ ipvs æ¨¡å—ï¼Œéœ€è¦å®‰è£…äº¤äº’è½¯ä»¶ ipvsadmï¼Œä½¿ç”¨ ipvsadm å’Œ ipvs è¿›è¡Œäº¤äº’ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;æˆ‘ä½¿ç”¨ 4 å° UCloud äº‘ä¸»æœºæ¥æ­å»ºå®éªŒç¯å¢ƒï¼Œåˆ›å»ºäº‘ä¸»æœºçš„æ—¶å€™é€‰æ‹©åˆ†æ—¶è´­ä¹°ï¼Œæ›´åˆ’ç®—ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®éªŒæœºå™¨åŠç¯å¢ƒ
&lt;ul&gt;
&lt;li&gt;4 å° UCloud äº‘ä¸»æœºï¼ŒCentOS 7.9 64ä½ï¼Œ1 æ ¸ 1 Gï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹é˜²ç«å¢™è§„åˆ™ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯ã€WebæœåŠ¡å™¨æ¨èã€‘ï¼Œå¼€æ”¾ 22ã€3389ã€80ã€443 çš„ç«¯å£å·ï¼Œè¿™ä¸ªå¯ä»¥è‡ªè¡Œé…ç½®
&lt;ul&gt;
&lt;li&gt;ä¸¤å° Real Serverï¼šRS01ã€RS02ï¼Œä¸€å°è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼šLB01&lt;/li&gt;
&lt;li&gt;RS01ï¼š10.23.190.76ã€RS02ï¼š10.23.122.152ã€LB01ï¼š10.23.21.184ã€LB02ï¼š10.23.115.100&lt;/li&gt;
&lt;li&gt;VIPï¼š10.23.88.247&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;RS01ã€RS02 å®‰è£… httpdï¼Œå¿«é€Ÿå¯åŠ¨ http æœåŠ¡å™¨ï¼Œä¸”é…ç½®ä¸åŒçš„è¯·æ±‚å“åº”&lt;/li&gt;
&lt;li&gt;LB01ã€LB02 å®‰è£… ipvsadmã€keepalivedï¼Œå¹¶å¯åŠ¨ ipvsadmã€keepalived&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®éªŒæœºå™¨å±•ç¤º
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_19.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_19.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;å®éªŒæœºå™¨&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;å®éªŒæœºå™¨&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;dr-æ¨¡å¼å®æ“&#34;&gt;DR æ¨¡å¼å®æ“&lt;/h2&gt;
&lt;p&gt;å›é¡¾ä¸€ä¸‹ DR æ¨¡å¼çš„ç‰¹ç‚¹&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_dr.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_dr.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;DR&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;DR&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;DR æ¨¡å¼ä»…ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œç›®æ ‡ MAC åœ°å€ã€ï¼Œåªæœ‰è¯·æ±‚æ•°æ®åŒ…éœ€è¦ç»è¿‡è´Ÿè½½å‡è¡¡å™¨ï¼Œæ‰€ä»¥ DR æ¨¡å¼ä¸æ”¯æŒå¯¹ç«¯å£çš„è½¬æ¢&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çœŸå®æœåŠ¡å™¨å’Œè´Ÿè½½å‡è¡¡å™¨å¿…é¡»åœ¨åŒä¸€ä¸ªç½‘æ®µï¼Œä¸”çœŸå®æœåŠ¡å™¨çš„é»˜è®¤ç½‘å…³ä¸èƒ½æ˜¯è´Ÿè½½å‡è¡¡å™¨&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çœŸå®æœåŠ¡å™¨çš„ lo æ¥å£ä¸Šéœ€è¦é…ç½® VIP çš„ IP åœ°å€ï¼Œä¸”çœŸå®æœåŠ¡å™¨éœ€è¦æ›´æ”¹ ARP åè®®ï¼Œâ€œéšè—â€ lo æ¥å£ä¸Šçš„ VIP&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‰ç½®å‡†å¤‡å·¥ä½œå’Œ NAT æ¨¡å¼çš„ä¸€æ ·ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¼€å§‹é…ç½® DR æ¨¡å¼ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;RS01ã€RS02&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¿®æ”¹ ARP åè®®
&lt;ul&gt;
&lt;li&gt;echo 1 &amp;gt; /proc/sys/net/ipv4/conf/lo/arp_ignore&lt;/li&gt;
&lt;li&gt;echo 1 &amp;gt; /proc/sys/net/ipv4/conf/lo/arp_ignore&lt;/li&gt;
&lt;li&gt;echo 2 &amp;gt; /proc/sys/net/ipv4/conf/lo/arp_announce&lt;/li&gt;
&lt;li&gt;echo 2 &amp;gt; /proc/sys/net/ipv4/conf/all/arp_announce&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åœ¨ lo æ¥å£ä¸Šé…ç½® VIP
&lt;ul&gt;
&lt;li&gt;ifconfig lo:0 10.23.21.184 netmask 255.255.255.255&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;éªŒè¯é…ç½®
&lt;ul&gt;
&lt;li&gt;ifconfig
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_20.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_20.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;ifconfig&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;ifconfig&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;LB01&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é…ç½®è·¯ç”±å…¥å£è§„åˆ™
&lt;ul&gt;
&lt;li&gt;ipvsadm -A -t 10.23.21.184:80 -s rr&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é…ç½®è·¯ç”±å‡ºå£è§„åˆ™
&lt;ul&gt;
&lt;li&gt;ipvsadm -a -t 10.23.21.184:80 -r 10.23.190.76 -g -w 1&lt;/li&gt;
&lt;li&gt;ipvsadm -a -t 10.23.21.184:80 -r 10.23.122.152 -g -w 1&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¦‚æœ VIP å’Œæœ¬æœºåœ°å€ä¸ä¸€è‡´ï¼Œè¦é…ç½® VIPï¼ˆæˆ‘è¿™é‡Œå°±ä¸ç”¨äº†ï¼‰
&lt;ul&gt;
&lt;li&gt;é…ç½® VIP
&lt;ul&gt;
&lt;li&gt;ifconfig eth0:0 VIP/24&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;éªŒè¯é…ç½®
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ipvsadm -ln
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_21.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_21.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;ipvsadm&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;ipvsadm&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ifconfig
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_22.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_22.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;ifconfig&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;ifconfig&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é…ç½®å®Œæˆï¼Œç°åœ¨æˆ‘ä»¬æ¥éªŒè¯ä¸‹ DR æ¨¡å¼ä¸‹çš„è´Ÿè½½å‡è¡¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_23.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_23.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°ç›´æ¥åœ¨æœ¬åœ°è¯·æ±‚ LB01 çš„å¤–ç½‘ IP åœ°å€æ—¶ï¼Œä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼Œæœ€ç»ˆæŠ¥é”™ï¼šOperation timed outã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ LB01 æœ‰æ²¡æœ‰æ­£ç¡®çš„æ”¶åˆ°è¿æ¥è¯·æ±‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥çœ‹ LB01 è®°å½•çš„è¿æ¥ä¿¡æ¯ï¼šipvsadm -Lnc
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_24.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_24.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;ipvsadm&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;ipvsadm&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ° LB01 æ­£ç¡®çš„æ”¶åˆ°äº†è¿æ¥è¯·æ±‚ï¼Œå¹¶ä¸”è½¬å‘ç»™äº† RS02ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç™»é™†åˆ° RS02 ä¸Šï¼Œæ£€æŸ¥ RS02 æ˜¯å¦æ¥æ”¶åˆ°äº†æ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥çœ‹ RS02 ä¸Šçš„ TCP è¿æ¥ä¿¡æ¯ï¼šnetstat -natp | grep 10.23.21.184
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_25.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_25.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;netstat&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;netstat&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;RS02 æ”¶åˆ°äº†æ•°æ®åŒ…ï¼Œå¹¶ä¸”ä¹Ÿå‘å‡ºäº†è¿”å›çš„æ•°æ®åŒ…ï¼Œè¿”å›æ•°æ®åŒ…çš„ IP åœ°å€å’Œç«¯å£å·ä¹Ÿå’Œå‘å‡ºçš„ä¸€è‡´ã€‚æ‰€ä»¥å¯ä»¥åˆç†åœ°çŒœæµ‹ï¼Œé—®é¢˜å‡ºåœ¨ç”± RS02 ç›´æ¥è¿”å›æ•°æ®åŒ…ç»™å®¢æˆ·ç«¯çš„è¿‡ç¨‹ä¸­ã€‚é‚£ä¹ˆåªæœ‰ä¸¤ç§æƒ…å†µï¼ŒRS02 æ— æ³•è¿æ¥åˆ°å®¢æˆ·ç«¯æˆ–è€…å®¢æˆ·ç«¯æ‹’ç»æ¥æ”¶è¿™ä¸ªæ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;æ£€æŸ¥ RS02 æ˜¯å¦èƒ½æ­£å¸¸è¿æ¥åˆ°å®¢æˆ·ç«¯&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ping 106.75.220.2
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_26.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_26.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;ping&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;ping&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;RS02 å’Œå®¢æˆ·ç«¯å¯ä»¥æ­£å¸¸è¯·æ±‚è®¿é—®ã€‚é‚£ä¹ˆåº”è¯¥æ˜¯å®¢æˆ·ç«¯æ‹’ç»æ¥æ”¶äº†è¿™ä¸ªæ•°æ®åŒ…ï¼ŒæŠ“åŒ…æ¥çœ‹ä¸‹ï¼Œå®¢æˆ·ç«¯æ˜¯å¦æœ‰æ”¶åˆ°è¿™ä¸ªæ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;å†æ¬¡è¯·æ±‚ LB01ï¼Œå¹¶æŸ¥çœ‹å®¢æˆ·ç«¯å’Œ LB01 äº¤äº’çš„æ•°æ®åŒ…&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;tcpdump host 106.75.253.112 -nne
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_27.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_27.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;tcpdump&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;tcpdump&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‘ç°åªæœ‰å‘å‡ºçš„æ•°æ®åŒ…ï¼Œè€Œæ²¡æœ‰æ”¶åˆ°çš„æ•°æ®åŒ…ã€‚ç°åœ¨æƒ…å†µæ˜¯ï¼šRS02 å‘å‡ºäº†æ•°æ®åŒ…ï¼Œä½†æ˜¯å®¢æˆ·ç«¯å´æ²¡æ”¶åˆ°ã€‚é‚£åªæœ‰ä¸€ç§å¯èƒ½ï¼Œå°±æ˜¯äº‘ä¸»æœºçš„ EIP è½¬å‘æ•°æ®åŒ…çš„æ—¶å€™ï¼Œç”±äºæŸç§æ¡ä»¶é™åˆ¶ï¼Œæ‰”æ‰äº†è¿™ä¸ªæ•°æ®åŒ…ã€‚å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œåœ¨å†…ç½‘ç¯å¢ƒä¸­åº”è¯¥æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„ã€‚æˆ‘ä»¬å†ç”³è¯·ä¸€å°åœ¨ç›¸åŒç½‘æ®µçš„äº‘ä¸»æœºï¼ŒéªŒè¯ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_28.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_28.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;æœç„¶æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„ï¼Œåæ¥å’Œå®˜æ–¹äº¤æµä¹‹åä¹Ÿè¯å®äº†è¿™ä¸€ç‚¹ã€‚ï¼ˆæˆ‘çŒœæµ‹åº”è¯¥æ˜¯å‡ºäºå¯¹å®‰å…¨çš„è€ƒè™‘ï¼Œæ‰€æœ‰è¿›å‡ºçš„æ•°æ®åŒ…ï¼ŒIP åœ°å€ å’Œ MAC åœ°å€å¿…é¡»å’Œæœ¬æœºä¸€è‡´ï¼Œå¦åˆ™æ•°æ®åŒ…ä¼šè¢«ä¸¢å¼ƒã€‚ï¼‰&lt;/p&gt;
&lt;p&gt;åˆ°æ­¤å®éªŒé…ç½®å®Œæˆï¼ŒéªŒè¯ä¹Ÿå®Œæˆï½&lt;/p&gt;
&lt;h2 id=&#34;keepalived-å®ç°-dr-æ¨¡å‹çš„é«˜å¯ç”¨æ€§å®æ“&#34;&gt;Keepalived å®ç° DR æ¨¡å‹çš„é«˜å¯ç”¨æ€§å®æ“&lt;/h2&gt;
&lt;p&gt;åœ¨æˆåŠŸæ­å»º DR æ¨¡å‹ä¹‹åï¼Œä¸ç”±å¾—æ€è€ƒè¿™ä¹ˆä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœè´Ÿè½½å‡è¡¡æœåŠ¡å™¨å®•æœºäº†æ€ä¹ˆåŠï¼Ÿè´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ‰¿è½½ç€å®¢æˆ·ç«¯å¯¹æœåŠ¡ç«¯çš„æ‰€æœ‰è¯·æ±‚è·¯ç”±ï¼Œå¦‚æœä¸€æ—¦å®•æœºï¼Œå½±å“çš„æ˜¯æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€äº›æªæ–½æ¥ä¿è¯è´Ÿè½½å‡è¡¡çš„é«˜å¯ç”¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;æœ€ç®€å•çš„åŠæ³•å°±æ˜¯å°†å•ç‚¹éƒ¨ç½²çš„è´Ÿè½½å‡è¡¡æœåŠ¡å™¨å˜æˆå¤šç‚¹éƒ¨ç½²ã€‚å¦‚æœå½“å‰ä½¿ç”¨çš„èŠ‚ç‚¹å‡ºç°é—®é¢˜ï¼Œè¿…é€Ÿåœ°åˆ‡æ¢åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯ç³»ç»Ÿçš„æ•´ä¸ªå¯ç”¨æ€§ã€‚é‚£ä¹ˆï¼Œç°åœ¨è´Ÿè½½å‡è¡¡æœåŠ¡å™¨å•ç‚¹æ•…éšœçš„é—®é¢˜å°±è½¬æ¢æˆå¤šç‚¹éƒ¨ç½²çš„åˆ‡æ¢é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è§£å†³å¤šç‚¹éƒ¨ç½²çš„åˆ‡æ¢é—®é¢˜ï¼Œéœ€è¦ä»€ä¹ˆæ¡ä»¶ï¼Ÿé¦–å…ˆæˆ‘ä»¬éœ€è¦å‘ç°é—®é¢˜ï¼Œå³éœ€è¦ä¸æ–­åœ°æ£€æŸ¥å½“å‰èŠ‚ç‚¹æ˜¯å¦æ­£å¸¸ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹ä¸æ­£å¸¸çš„è¯ï¼Œéœ€è¦å¿«é€Ÿåœ°åˆ‡æ¢åˆ°å…¶ä»–çš„èŠ‚ç‚¹ä¸Šã€‚keepalived å°±æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥å®é™…æ“ä½œä¸€ä¸‹ï½&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;RS01ã€RS02 å’Œ DR æ¨¡å‹å®æ“ç±»ä¼¼ï¼Œåªä¸è¿‡æˆ‘ä»¬è¦é‡æ–°ç”³è¯·ä¸€ä¸ª VIPï¼š10.23.88.247ï¼Œç»‘å®šåœ¨ RS01ã€RS02 çš„ lo:0 ä¸Š
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_29.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_29.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ifconfig lo:0 10.23.88.247 netmask 255.255.255.255 broadcast 10.23.88.247 up&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;LB01ã€LB02&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å®‰è£… ipvsadmã€keepalived&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;yum install ipvsadm keepalived -y&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¿®æ”¹ keepalived é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;cp keepalived.conf keepalived.conf.bak&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;! Configuration File for keepalived

vrrp_instance VI_1 {
    state MASTER  // å¤‡èŠ‚ç‚¹ï¼šBACKUP
    interface eth0
    virtual_router_id 51
    priority 100  // å¤‡èŠ‚ç‚¹ï¼š50
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass 1111
    }
    virtual_ipaddress {
        10.23.88.247 dev eth0
    }
}

virtual_server 10.23.88.247 80 {
    delay_loop 6
    lb_algo rr
    lb_kind DR
        nat_mask 255.255.0.0
    persistence_timeout 0
    protocol TCP

    real_server 10.23.190.76 80 {
        weight 1
                HTTP_GET {
                url {
                        path /
                status_code 200
                }
            connect_timeout 3
            nb_get_retry 3
            delay_before_retry 3
            }
    }
    real_server 10.23.122.152 80 {
        weight 1
        HTTP_GET {
            url {
                path /
                status_code 200
            }
            connect_timeout 3
            nb_get_retry 3
            delay_before_retry 3
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;é‡æ–°å¯åŠ¨ keepalived
&lt;ul&gt;
&lt;li&gt;systemctl restart keepalived&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;éªŒè¯ keepalived DR æ¨¡å‹&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_30.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_30.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;éªŒè¯&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;éªŒè¯&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥æ­£å¸¸è®¿é—®åˆ°ä¸¤å°æœåŠ¡å™¨ï¼Œæ¥ä¸‹æ¥æŠŠ LB01 çš„ keepalived åœæ‰ï¼Œç»§ç»­è®¿é—® VIPã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_31.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_31.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;éªŒè¯&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;éªŒè¯&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®ï¼ŒVIP æ¼‚åˆ°äº† LB02 ä¸Šã€‚ä½¿ç”¨ ipvsadm -lnc æŸ¥çœ‹å…·ä½“è¿æ¥ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;å®éªŒå®Œæˆï¼Œå·®ä¸å¤šæ–­æ–­ç»­ç»­çš„ç”¨äº† 4.5 å°æ—¶ï¼ŒåŒ…æ‹¬ä¸€äº›é¢å¤–çš„æ’æŸ¥æ—¶é—´ï¼Œå…±è®¡èŠ±è´¹ä¸åˆ° 5 å—ï½&lt;/p&gt;
</description>
        </item>
        <item>
        <title>æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆä¸‰ï¼‰å®æ“ NATã€TUNNEL æ¨¡å‹</title>
        <link>https://boxtsecond.github.io/zh-cn/dev/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA-lvs-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E4%B8%89%E5%AE%9E%E6%93%8D-nattunnel-%E6%A8%A1%E5%9E%8B/</link>
        <pubDate>Tue, 05 Sep 2023 18:52:03 +0800</pubDate>
        
        <guid>https://boxtsecond.github.io/zh-cn/dev/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA-lvs-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E4%B8%89%E5%AE%9E%E6%93%8D-nattunnel-%E6%A8%A1%E5%9E%8B/</guid>
        <description>&lt;p&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ç³»åˆ—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆä¸€ï¼‰NATã€FULLNAT æ¨¡å‹åŸç†
&lt;ul&gt;
&lt;li&gt;ä¸¤å°è®¡ç®—æœºå¦‚ä½•åœ¨äº’è”ç½‘ä¸­é€šä¿¡&lt;/li&gt;
&lt;li&gt;LVS è´Ÿè½½å‡è¡¡
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œæº IP åœ°å€ã€æˆ–Â ã€Œç›®æ ‡ IP åœ°å€ã€
&lt;ul&gt;
&lt;li&gt;NAT æ¨¡å¼&lt;/li&gt;
&lt;li&gt;FULLNAT æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆäºŒï¼‰DRã€TUN æ¨¡å‹åŸç†
&lt;ul&gt;
&lt;li&gt;LVS è´Ÿè½½å‡è¡¡
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œç›®æ ‡ MAC åœ°å€ã€
&lt;ul&gt;
&lt;li&gt;DR æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€šè¿‡äºŒæ¬¡å°è£…æ•°æ®åŒ…çš„ã€ŒIP æŠ¥æ–‡ã€
&lt;ul&gt;
&lt;li&gt;TUN æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆä¸‰ï¼‰å®æ“ NATã€TUNNEL æ¨¡å‹ã€æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆå››ï¼‰å®æ“ DR æ¨¡å‹ã€Keepalived DR æ¨¡å‹çš„é«˜å¯ç”¨
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ UCloud äº‘ä¸»æœºå®æ“å„ä¸ªæ¨¡å‹&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ Keepalived å®ç° LVS-DR çš„é«˜å¯ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;LVSï¼ˆLinux Virtual Serverï¼‰æ˜¯ä¸€ä¸ªè™šæ‹ŸæœåŠ¡å™¨é›†ç¾¤ç³»ç»Ÿã€‚å·¥ä½œåœ¨ OSI æ¨¡å‹çš„ä¼ è¾“å±‚ï¼Œå³å››å±‚è´Ÿè½½å‡è¡¡ã€‚LVS æœ¬èº«å®ç°äº† NATã€DRã€TUN æ¨¡å‹ï¼Œè¿™äº›æ¨¡å‹ä»…åšæ•°æ®åŒ…çš„è½¬å‘ï¼Œè€Œä¸ä¼šä¸å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œæˆæœ¬ä½æ•ˆç‡é«˜ã€‚FULLNAT åŸºäº NAT å®ç°ï¼ŒLVS æœ¬èº«ä¸æ”¯æŒï¼Œéœ€è¦é¢å¤–å¯¹å†…æ ¸æ‰“è¡¥ä¸åæ‰èƒ½ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;aside&gt;
ğŸ“Œ æœ¬ç³»åˆ—æŒ‰ç…§è´Ÿè½½å‡è¡¡å™¨å¯¹æ•°æ®åŒ…çš„å¤„ç†æ–¹å¼åˆ†ç±»ï¼Œä»è®¡ç®—æœºé—´é€šä¿¡çš„è§’åº¦å‡ºå‘ï¼Œæµ…è°ˆ NATã€FULLNATã€DRã€TUN æ¨¡å‹çš„å®ç°åŸç†ã€‚
&lt;/aside&gt;
&lt;p&gt;ä¹‹å‰ä»‹ç»äº† LVS è´Ÿè½½å‡è¡¡ NATã€FULLNATã€DRã€TUN æ¨¡å‹çš„å®ç°åŸç†ã€‚ç°åœ¨æ¥åŠ¨æ‰‹å®è·µä¸€ä¸‹ï½&lt;/p&gt;
&lt;h2 id=&#34;å®éªŒç¯å¢ƒ&#34;&gt;å®éªŒç¯å¢ƒ&lt;/h2&gt;
&lt;p&gt;LVS ç›®å‰å·²ç»æ˜¯ Linux å†…æ ¸ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨å†…æ ¸ä¸­çš„æ¨¡å—å«åš ipvsï¼Œæ”¯æŒ NATã€DRã€TUNNEL æ¨¡å‹ã€‚ç”¨æˆ·ä¸èƒ½ç›´æ¥æ“ä½œ ipvs æ¨¡å—ï¼Œéœ€è¦å®‰è£…äº¤äº’è½¯ä»¶ ipvsadmï¼Œä½¿ç”¨ ipvsadm å’Œ ipvs è¿›è¡Œäº¤äº’ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;æˆ‘ä½¿ç”¨ 3 å° UCloud äº‘ä¸»æœºæ¥æ­å»ºå®éªŒç¯å¢ƒï¼Œåˆ›å»ºäº‘ä¸»æœºçš„æ—¶å€™é€‰æ‹©åˆ†æ—¶è´­ä¹°ï¼Œæ›´åˆ’ç®—ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®éªŒæœºå™¨åŠç¯å¢ƒ
&lt;ul&gt;
&lt;li&gt;3 å° UCloud äº‘ä¸»æœºï¼ŒCentOS 7.9 64ä½ï¼Œ1 æ ¸ 1 Gï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹é˜²ç«å¢™è§„åˆ™ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯ã€WebæœåŠ¡å™¨æ¨èã€‘ï¼Œå¼€æ”¾ 22ã€3389ã€80ã€443 çš„ç«¯å£å·ï¼Œè¿™ä¸ªå¯ä»¥è‡ªè¡Œé…ç½®
&lt;ul&gt;
&lt;li&gt;ä¸¤å° Real Serverï¼šRS01ã€RS02ï¼Œä¸€å°è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼šLB01&lt;/li&gt;
&lt;li&gt;RS01ï¼š10.23.190.76ã€RS02ï¼š10.23.122.152ã€LB01ï¼š10.23.21.184&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;RS01ã€RS02 å®‰è£… httpdï¼Œå¿«é€Ÿå¯åŠ¨ http æœåŠ¡å™¨ï¼Œä¸”é…ç½®ä¸åŒçš„è¯·æ±‚å“åº”&lt;/li&gt;
&lt;li&gt;LB01 å®‰è£… ipvsadmï¼Œå¹¶å¯åŠ¨ ipvsadm&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®éªŒæœºå™¨å±•ç¤º
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_1.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_1.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;å®éªŒæœºå™¨&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;å®éªŒæœºå™¨&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;nat-æ¨¡å¼å®æ“&#34;&gt;NAT æ¨¡å¼å®æ“&lt;/h2&gt;
&lt;p&gt;å›é¡¾ä¸€ä¸‹ NAT æ¨¡å¼çš„ç‰¹ç‚¹&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_2.svg&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_2.svg&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;NAT&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;NAT&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;NAT æ¨¡å¼ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œç›®æ ‡ IP åœ°å€ã€æˆ– ã€Œæº IP åœ°å€ã€ï¼Œæ‰€æœ‰çš„è¯·æ±‚æ•°æ®åŒ…ã€å“åº”æ•°æ®åŒ…éƒ½è¦ç»è¿‡è´Ÿè½½å‡è¡¡å™¨ï¼Œæ‰€ä»¥ NAT æ¨¡å¼æ”¯æŒå¯¹ç«¯å£çš„è½¬æ¢&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çœŸå®æœåŠ¡å™¨çš„é»˜è®¤ç½‘å…³æ˜¯è´Ÿè½½å‡è¡¡å™¨ï¼Œæ‰€ä»¥çœŸå®æœåŠ¡å™¨å’Œè´Ÿè½½å‡è¡¡å™¨å¿…é¡»åœ¨åŒä¸€ä¸ªç½‘æ®µ&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å®æ“å¼€å§‹ï¼Œé¦–å…ˆæˆ‘ä»¬è¦åšä¸€äº›å‰ç½®çš„å‡†å¤‡å·¥ä½œï¼Œå³æŠŠè¯¥å®‰è£…çš„è½¯ä»¶å’ŒæœåŠ¡ï¼Œå®‰è£…å’Œå¯åŠ¨èµ·æ¥ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;RS01ã€RS02 å®‰è£… httpdï¼Œå¿«é€Ÿå¯åŠ¨ http æœåŠ¡&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;yum install httpd -y &amp;amp;&amp;amp; service httpd start&lt;/li&gt;
&lt;li&gt;echo &amp;ldquo;Hello From RS01/RS02&amp;rdquo; &amp;gt; /var/www/html/index.html&lt;/li&gt;
&lt;li&gt;éªŒè¯ï¼šcurl 0.0.0.0ï¼Œè¿”å›å¯¹åº”çš„ä¿¡æ¯
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_2.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_2.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;curl 0.0.0.0&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;curl 0.0.0.0&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;LB01 å®‰è£… ipvsadmï¼Œå¹¶å¯åŠ¨ ipvsadm&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;yum install ipvsadm &amp;amp;&amp;amp; ipvsadm &amp;ndash;save&amp;gt; /etc/sysconfig/ipvsadm &amp;amp;&amp;amp; service ipvsadm start&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°ä¸‹å›¾å°±è¡¨ç¤ºæˆåŠŸå¯åŠ¨äº† ipvsadm
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_3.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_3.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;ipvsadm&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;ipvsadm&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åšå®Œè¿™äº›å‰ç½®å‡†å¤‡å·¥ä½œä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥å¯¹ç…§ NAT æ¨¡å¼æ¥é…ç½®å…·ä½“çš„è´Ÿè½½è§„åˆ™ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;RS01ã€RS02&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è®¾ç½®é»˜è®¤ç½‘å…³ä¸º DIPï¼Œå³ LB01 çš„å†…ç½‘ IP - 10.23.21.184
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æŸ¥çœ‹ RS01ã€RS02 å½“å‰çš„é»˜è®¤ç½‘å…³&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;route -n
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_4.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_4.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;route -n&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;route -n&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å½“å‰çš„é»˜è®¤ç½‘å…³æ˜¯ 10.23.0.1&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è®¾ç½®é»˜è®¤ç½‘å…³ä¸º 10.23.21.184&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;route add default gw 10.23.21.184&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¾“å…¥å‘½ä»¤å¹¶æŒ‰ä¸‹å›è½¦ä¹‹åï¼Œä¼šå¾ˆé•¿æ—¶é—´æ²¡æœ‰å“åº”ï¼Œæ˜¯æ­£å¸¸çš„ã€‚æˆ‘ä»¬ç­‰å®ƒè¿æ¥æ–­æ‰ä¹‹åï¼Œå†é€šè¿‡ LB01 ç™»é™†åˆ° RS01ã€RS02 ä¸Š
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_5.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_5.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_6.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_6.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ é™¤ä¹‹å‰çš„é»˜è®¤ç½‘å…³&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;route del default gw 10.23.0.1
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_7.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_7.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;LB01&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;é…ç½®è·¯ç”±å…¥å£è§„åˆ™ï¼Œä½¿ç”¨ -A å‚æ•°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å› ä¸ºå®éªŒä½¿ç”¨çš„æ˜¯äº‘ä¸»æœºï¼Œè€Œäº‘ä¸»æœºçš„ EIP æˆ–è€…è¯´å¤–ç½‘ IP åœ°å€ï¼Œæœ¬èº«å°±æ˜¯é€šè¿‡ NAT æ–¹å¼æ˜ å°„åˆ°äº†ç»‘å®šçš„äº‘ä¸»æœºä¸Šï¼Œæ‰€ä»¥ä¸èƒ½å°† EIP å½“ä½œ VIP ç»‘å®šç«¯å£ã€‚è¿™é‡Œå°±ç›´æ¥å°†å†…ç½‘ IP  å½“ä½œ DIP ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ipvsadm -A -t 10.23.21.184:8000 -s rr&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é…ç½®è·¯ç”±å…¥å£è§„åˆ™ï¼Œä½¿ç”¨ -a å‚æ•°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ipvsadm -a -t 10.23.21.184:8000 -r 10.23.190.76:80 -m&lt;/li&gt;
&lt;li&gt;ipvsadm -a -t 10.23.21.184:8000 -r 10.23.122.152:80 -m&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;éªŒè¯é…ç½®&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ipvsadm -ln
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_8.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_8.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¼€å¯è·¯ç”±è½¬å‘&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;echo 1 &amp;gt;/proc/sys/net/ipv4/ip_forward&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œå¤§æ¦‚è§£é‡Šä¸‹å¯¹ ipvsadm çš„é…ç½®ä¿¡æ¯&lt;/br&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;-A æ·»åŠ ä¸€æ¡æ–°çš„è™šæ‹ŸæœåŠ¡å™¨è®°å½•ï¼Œå³æ·»åŠ ä¸€å°æ–°çš„è™šæ‹ŸæœåŠ¡å™¨&lt;/td&gt;&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;-a æ·»åŠ ä¸€æ¡æ–°çš„çœŸå®æœåŠ¡å™¨è®°å½•ï¼Œå³åœ¨è™šæ‹ŸæœåŠ¡å™¨ä¸­æ·»åŠ ä¸€å°çœŸå®æœåŠ¡å™¨&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;-t çœŸå®æœåŠ¡å™¨æä¾›çš„æ˜¯ TCP æœåŠ¡&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;-s è´Ÿè½½å‡è¡¡ä½¿ç”¨çš„è°ƒåº¦ç®—æ³•ï¼Œrr è¡¨ç¤ºè½®è¯¢&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;-w è®¾ç½®æƒé‡&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;-r æŒ‡å®šçœŸå®æœåŠ¡å™¨&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;-m æŒ‡å®š LVS ä½¿ç”¨ NAT æ¨¡å¼&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;-g æŒ‡å®š LVS ä½¿ç”¨ DR æ¨¡å¼&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;-i æŒ‡å®š LVS ä½¿ç”¨ TUNNEL æ¨¡å¼&lt;/br&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬é…ç½®çš„æ˜¯ä½¿ç”¨ NAT æ¨¡å¼ï¼Œè°ƒåº¦ç®—æ³•ä¸ºè½®è¯¢ã€‚&lt;/p&gt;
&lt;p&gt;åˆ°è¿™é‡Œæˆ‘ä»¬çš„é…ç½®å°±å…¨éƒ¨å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬éªŒè¯ä¸€ä¸‹ LB01 èƒ½ä¸èƒ½æŒ‰ç…§é¢„æœŸè´Ÿè½½åˆ° RS01ã€RS02 ã€‚ä½¿ç”¨æµè§ˆå™¨ç›´æ¥æ‰“å¼€ LB01 çš„å¤–ç½‘ IP åœ°å€ã€‚&lt;/p&gt;
&lt;table&gt;
    &lt;tr&gt;
        &lt;td &gt;&lt;center&gt;&lt;img src=&#34;https://boxtsecond.github.io/post/networks/img/lb4_m_9.png&#34; &gt;&lt;/center&gt;&lt;/td&gt;
        &lt;td &gt;&lt;center&gt;&lt;img src=&#34;https://boxtsecond.github.io/post/networks/img/lb4_m_10.png&#34;  &gt;&lt;/center&gt;&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;
&lt;p&gt;ç”±äºæµè§ˆå™¨çš„ç¼“å­˜æœºåˆ¶ï¼Œåœ¨çŸ­æ—¶é—´å†…åˆ·æ–°çš„æ—¶å€™ï¼Œè¿”å›å¯èƒ½ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚å¯ä»¥ä½¿ç”¨ curl æ›´å‡†ç¡®çš„æŸ¥çœ‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_11.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_11.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;éªŒè¯&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;éªŒè¯&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;éªŒè¯æˆåŠŸï½&lt;/p&gt;
&lt;h2 id=&#34;tunnel-æ¨¡å¼å®æ“&#34;&gt;TUNNEL æ¨¡å¼å®æ“&lt;/h2&gt;
&lt;p&gt;å›é¡¾ä¸€ä¸‹ TUNNEL æ¨¡å¼çš„ç‰¹ç‚¹&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_tunnel.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_tunnel.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;TUN&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;TUN&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;TUNNEL æ¨¡å¼ä¸æ”¹å˜åŸæ•°æ®åŒ…ï¼Œè€Œæ˜¯åœ¨åŸæ•°æ®åŒ…ä¸Šæ–°å¢ä¸€å±‚ IP é¦–éƒ¨ä¿¡æ¯ã€‚æ‰€ä»¥ TUNNEl æ¨¡å¼ä¸æ”¯æŒå¯¹ç«¯å£çš„è½¬æ¢ï¼Œä¸”çœŸå®æœåŠ¡å™¨å¿…é¡»èƒ½å¤Ÿæ”¯æŒè§£æä¸¤å±‚ IP é¦–éƒ¨ä¿¡æ¯&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çœŸå®æœåŠ¡å™¨å’Œè´Ÿè½½å‡è¡¡å™¨å¯ä»¥ä¸åœ¨åŒä¸€ä¸ªç½‘æ®µä¸­&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çœŸå®æœåŠ¡å™¨éœ€è¦æ›´æ”¹ ARP åè®®ï¼Œâ€œéšè—â€ lo æ¥å£ä¸Šçš„ VIP&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;TUNNEL æ¨¡å¼å’Œå…¶ä»–æ¨¡å¼æœ‰ç‚¹ä¸åŒï¼Œä¸èƒ½åƒä¹‹å‰é‚£æ ·ç›´æ¥ä½¿ç”¨ VIP æ¥å……å½“ DIPã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦é¢å¤–ä¸€ä¸ª DIPï¼š10.23.21.180ã€‚&lt;/p&gt;
&lt;p&gt;å¼€å§‹é…ç½®å…·ä½“çš„è´Ÿè½½è§„åˆ™ï½&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;RS01ã€RS02&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å®‰è£… ipip æ¨¡å—&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;modprobe ipip&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;éªŒè¯ ipip æ¨¡å—æ˜¯å¦åŠ è½½æˆåŠŸ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;lsmod | grep ipip&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_12.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_12.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;ipip&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;ipip&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¿®æ”¹ ARP åè®®&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;echo 1 &amp;gt; /proc/sys/net/ipv4/conf/tunl0/arp_ignore&lt;/li&gt;
&lt;li&gt;echo 2 &amp;gt; /proc/sys/net/ipv4/conf/tunl0/arp_announce&lt;/li&gt;
&lt;li&gt;echo 1 &amp;gt; /proc/sys/net/ipv4/conf/all/arp_ignore&lt;/li&gt;
&lt;li&gt;echo 2 &amp;gt; /proc/sys/net/ipv4/conf/all/arp_announce&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;rp_filter è¡¨ç¤ºæ˜¯å¦å¼€å¯å¯¹æ•°æ®åŒ…æºåœ°å€çš„æ ¡éªŒï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥å…³é—­æ ¡éªŒå³å¯ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;echo 0 &amp;gt; /proc/sys/net/ipv4/conf/tunl0/rp_filter&lt;/li&gt;
&lt;li&gt;echo 0 &amp;gt; /proc/sys/net/ipv4/conf/all/rp_filter&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é…ç½® DIP&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ifconfig tunl0 10.23.21.180 broadcast 10.23.21.180 netmask 255.255.255.255 up&lt;/li&gt;
&lt;li&gt;route add -host 10.23.21.180 tunl0&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;éªŒè¯é…ç½®&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ifconfig
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_13.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_13.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;ifconfig&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;ifconfig&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;route -n
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_14.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_14.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;route -n&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;route -n&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;LB01&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é…ç½®è·¯ç”±å…¥å£è§„åˆ™
&lt;ul&gt;
&lt;li&gt;ipvsadm -A -t 10.23.21.180:80 -s wrr&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é…ç½®è·¯ç”±å‡ºå£è§„åˆ™ï¼Œç”±äºåœ¨ä¸åŒçš„ç½‘æ®µï¼Œè¿™é‡Œéœ€è¦é…ç½® RS01ã€RS02 çš„å¤–ç½‘åœ°å€
&lt;ul&gt;
&lt;li&gt;ipvsadm -a -t 10.23.21.180:80 -r 10.23.190.76 -i -w 1&lt;/li&gt;
&lt;li&gt;ipvsadm -a -t 10.23.21.180:80 -r 10.23.122.152 -i -w 1&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é…ç½® DIP
&lt;ul&gt;
&lt;li&gt;å®‰è£… ipip æ¨¡å—
&lt;ul&gt;
&lt;li&gt;modprobe ipip&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ifconfig tunl0 10.23.21.180 broadcast 10.23.21.180 netmask 255.255.255.255 up&lt;/li&gt;
&lt;li&gt;route add -host 10.23.21.180 tunl0&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;éªŒè¯é…ç½®
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ipvsadm -ln
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_15.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_15.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;ipvsadm&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;ipvsadm&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;route -n
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_16.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_16.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;route -n&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;route -n&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é…ç½®å®Œæˆï¼Œæˆ‘ä»¬å†ç”³è¯·ä¸€å°äº‘ä¸»æœºæ¥éªŒè¯å®æ“ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;DIP æ˜¯æˆ‘ä»¬è™šæ‹Ÿå‡ºæ¥çš„ IP åœ°å€ï¼Œæ‰€ä»¥å®é™…åœ¨ç½‘ç»œä¸­æ˜¯æ‰¾ä¸åˆ°çš„ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ‰‹åŠ¨å°†è®¿é—® DIP çš„è·¯ç”±ï¼Œè®¿é—®åˆ° LB01 ä¸Šã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;route add -host 10.23.21.180 gw 10.23.21.184&lt;/li&gt;
&lt;li&gt;éªŒè¯ä¸€ä¸‹
&lt;ul&gt;
&lt;li&gt;route -n
&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_17.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_17.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;route -n&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;route -n&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç°åœ¨è®©æˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹ TUNNEL æ¨¡å‹æ˜¯å¦æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_18.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_m_18.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;éªŒè¯&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;éªŒè¯&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;éªŒè¯æˆåŠŸï½&lt;/p&gt;
&lt;p&gt;ä¸‹ç¯‡ç»§ç»­ DR æ¨¡å‹çš„å®æ“ï¼ŒåŠä½¿ç”¨ Keepalived å®ç° DR æ¨¡å‹çš„é«˜å¯ç”¨ã€‚&lt;/p&gt;
</description>
        </item>
        <item>
        <title>æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆäºŒï¼‰DRã€TUN æ¨¡å‹åŸç†</title>
        <link>https://boxtsecond.github.io/zh-cn/dev/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA-lvs-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E4%BA%8Cdrtun-%E6%A8%A1%E5%9E%8B%E5%8E%9F%E7%90%86/</link>
        <pubDate>Tue, 05 Sep 2023 16:52:03 +0800</pubDate>
        
        <guid>https://boxtsecond.github.io/zh-cn/dev/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA-lvs-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E4%BA%8Cdrtun-%E6%A8%A1%E5%9E%8B%E5%8E%9F%E7%90%86/</guid>
        <description>&lt;p&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ç³»åˆ—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆä¸€ï¼‰NATã€FULLNAT æ¨¡å‹åŸç†
&lt;ul&gt;
&lt;li&gt;ä¸¤å°è®¡ç®—æœºå¦‚ä½•åœ¨äº’è”ç½‘ä¸­é€šä¿¡&lt;/li&gt;
&lt;li&gt;LVS è´Ÿè½½å‡è¡¡
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œæº IP åœ°å€ã€æˆ–ã€Œç›®æ ‡ IP åœ°å€ã€
&lt;ul&gt;
&lt;li&gt;NAT æ¨¡å¼&lt;/li&gt;
&lt;li&gt;FULLNAT æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆäºŒï¼‰DRã€TUN æ¨¡å‹åŸç†
&lt;ul&gt;
&lt;li&gt;LVS è´Ÿè½½å‡è¡¡
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œç›®æ ‡ MAC åœ°å€ã€
&lt;ul&gt;
&lt;li&gt;DR æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€šè¿‡äºŒæ¬¡å°è£…æ•°æ®åŒ…çš„ã€ŒIP æŠ¥æ–‡ã€
&lt;ul&gt;
&lt;li&gt;TUN æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆä¸‰ï¼‰å®æ“ NATã€DR æ¨¡å‹ã€æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆå››ï¼‰å®æ“ TUNNEL æ¨¡å‹ã€Keepalived DR æ¨¡å‹çš„é«˜å¯ç”¨
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ UCloud äº‘ä¸»æœºå®æ“å„ä¸ªæ¨¡å‹&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ Keepalived å®ç° LVS-DR çš„é«˜å¯ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;LVSï¼ˆLinux Virtual Serverï¼‰æ˜¯ä¸€ä¸ªè™šæ‹ŸæœåŠ¡å™¨é›†ç¾¤ç³»ç»Ÿã€‚å·¥ä½œåœ¨ OSI æ¨¡å‹çš„ä¼ è¾“å±‚ï¼Œå³å››å±‚è´Ÿè½½å‡è¡¡ã€‚LVS æœ¬èº«å®ç°äº† NATã€DRã€TUN æ¨¡å‹ï¼Œè¿™äº›æ¨¡å‹ä»…åšæ•°æ®åŒ…çš„è½¬å‘ï¼Œè€Œä¸ä¼šä¸å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œæˆæœ¬ä½æ•ˆç‡é«˜ã€‚FULLNAT åŸºäº NAT å®ç°ï¼ŒLVS æœ¬èº«ä¸æ”¯æŒï¼Œéœ€è¦é¢å¤–å¯¹å†…æ ¸æ‰“è¡¥ä¸åæ‰èƒ½ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;aside&gt;
ğŸ“Œ æœ¬ç³»åˆ—æŒ‰ç…§è´Ÿè½½å‡è¡¡å™¨å¯¹æ•°æ®åŒ…çš„å¤„ç†æ–¹å¼åˆ†ç±»ï¼Œä»è®¡ç®—æœºé—´é€šä¿¡çš„è§’åº¦å‡ºå‘ï¼Œæµ…è°ˆ NATã€FULLNATã€DRã€TUN æ¨¡å‹çš„å®ç°åŸç†ã€‚
&lt;/aside&gt;
&lt;p&gt;ä¸Šç¯‡ä»è®¡ç®—æœºé—´çš„é€šä¿¡è¯´èµ·ï¼ŒçŸ¥é“é€šä¿¡å¿…è¦çš„å…­è¦ç´ æ˜¯ æº IP åœ°å€ã€ç«¯å£å·ã€æº MAC åœ°å€ï¼Œç›®æ ‡ IP åœ°å€ã€ç«¯å£å·ã€ç›®æ ‡ MAC åœ°å€ã€‚å…¶ä¸­ï¼Œç«¯å£å·æ ‡å¿—äº†åœ¨åº”ç”¨å±‚çš„ä¸¤ä¸ªå…·ä½“åº”ç”¨ä¿¡æ¯ï¼Œå³å¿«é€’çš„å…·ä½“å‘é€äººå’Œæ¥æ”¶äººï¼ŒIP åœ°å€è¡¨ç¤ºåœ¨ç½‘ç»œå±‚ä¸Šä¸¤ä¸ªç«¯ç‚¹çš„åœ°å€ï¼Œå³å¿«é€’çš„å‘å‡ºåœ°å€å’Œæ”¶è´§åœ°å€ï¼ŒMAC åœ°å€è¡¨ç¤ºåœ¨æ•°æ®é“¾è·¯å±‚ä¸ŠèŠ‚ç‚¹é—´çš„åœ°å€ï¼Œå³å¿«é€’ä¼ é€ä¸­çš„å„ä¸ªé©¿ç«™çš„åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨äº†è§£ LVS çš„ NATã€FULLNAT æ¨¡å‹å¯¹æ•°æ®åŒ…çš„ä¿®æ”¹æ–¹å¼ä»¥åŠå®ƒä»¬çš„ç¼ºç‚¹ä¹‹åï¼Œç«™åœ¨ NAT æ¨¡å‹çš„è‚©è†€ä¸Šï¼Œæ€æ ·æ‰èƒ½æ›´å¥½åœ°ä¼˜åŒ–è´Ÿè½½å‡è¡¡å™¨ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨ NAT å’Œ FULLNAT æ¨¡å¼ä¸­ï¼Œä¸ç®¡æ˜¯è¯·æ±‚æ•°æ®åŒ…è¿˜æ˜¯å“åº”æ•°æ®åŒ…ï¼Œéƒ½è¦ç»è¿‡è´Ÿè½½å‡è¡¡å™¨ã€‚ä½†æ˜¯å“åº”æ•°æ®åŒ…ä¸€èˆ¬è¦æ¯”è¯·æ±‚æ•°æ®åŒ…å¤§å¾ˆå¤šï¼Œè¿™å¯èƒ½ä¼šæˆä¸ºç³»ç»Ÿçš„ç“¶é¢ˆã€‚å¦‚æœèƒ½å¤Ÿå°†è¯·æ±‚æ•°æ®åŒ…è½¬å‘åˆ°çœŸå®æœåŠ¡å™¨ä¹‹åï¼Œå“åº”æ•°æ®åŒ…ç”±çœŸå®æœåŠ¡å™¨ç›´æ¥è¿”å›ï¼Œè¿™æ ·å¯¹è´Ÿè½½å‡è¡¡å™¨çš„å‹åŠ›å°±å°å¾ˆå¤šã€‚è¿™ç§æ¨¡å¼åˆåº”è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿ&lt;/p&gt;
&lt;h2 id=&#34;lvs-è´Ÿè½½å‡è¡¡&#34;&gt;LVS è´Ÿè½½å‡è¡¡&lt;/h2&gt;
&lt;h3 id=&#34;dr-æ¨¡å¼&#34;&gt;DR æ¨¡å¼&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;å¦‚æœçœŸçš„èƒ½å¤Ÿç”±çœŸå®æœåŠ¡å™¨ç›´æ¥å“åº”å®¢æˆ·ç«¯ï¼Œè€Œä¸ç»è¿‡è´Ÿè½½å‡è¡¡å™¨ã€‚é‚£ä¹ˆè¿™ä¸ªç”±è´Ÿè½½å‡è¡¡å™¨ç›´æ¥å“åº”å›å®¢æˆ·ç«¯çš„æ•°æ®åŒ…éœ€è¦æ»¡è¶³ä»€ä¹ˆæ¡ä»¶ï¼Œæ‰èƒ½è¢«å®¢æˆ·ç«¯æ­£å¸¸æ¥æ”¶ï¼Ÿ&lt;/p&gt;
&lt;p&gt;çœŸå®æœåŠ¡å™¨å‘å‡ºçš„æ•°æ®åŒ…ï¼Œåœ¨å®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„æ—¶å€™ï¼Œä¸€å®šè¦åŒ¹é…å¾—ä¸Šä»å®¢æˆ·ç«¯å‘å‡ºçš„æ•°æ®åŒ…ã€‚å¦‚æœä¸åŒ¹é…çš„è¯ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°å“åº”æ•°æ®åŒ…åä¼šç›´æ¥å°†æ•°æ®åŒ…ä¸¢å¼ƒã€‚&lt;/p&gt;
&lt;aside&gt;
ğŸ“Œ å®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚æ•°æ®åŒ…ï¼šCIP â¡ï¸  VIPï¼Œåˆ™æ”¶åˆ°çš„å“åº”æ•°æ®åŒ…ä¸€å®šæ˜¯ VIP â¡ï¸  CIPã€‚
&lt;p&gt;ğŸ’¡åšä¸ªå°æ€è€ƒï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰å¸¦ä¸Š MAC åœ°å€ï¼Ÿåæ–‡æœ‰è§£é‡Šï½&lt;/p&gt;
&lt;/aside&gt;
&lt;p&gt;ä½†æ˜¯ VIP å·²ç»ç»‘å®šåœ¨è´Ÿè½½å‡è¡¡å™¨ä¸Šï¼ŒçœŸå®æœåŠ¡å™¨ä¹Ÿæœ‰å¤šä¸ªï¼Œåœ¨è¿é€šçš„ç½‘ç»œé‡Œï¼Œå¦‚ä½•èƒ½è®©å¤šä¸ªçœŸå®æœåŠ¡å™¨å’Œè´Ÿè½½å‡è¡¡å™¨çš„ VIP åœ°å€ç›¸åŒï¼Ÿå¹¶ä¸”çœŸå®æœåŠ¡å™¨çš„ VIP ä¸èƒ½è¢«å…¶ä»–è®¾å¤‡è®¿é—®çš„åˆ°ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨æ¯å°çœŸå®æœåŠ¡å™¨ä¸Šçš„ VIP åœ°å€ï¼Œåªèƒ½å®ƒä»¬è‡ªå·±çŸ¥é“â€œæˆ‘æ‚„æ‚„è—ç€ VIPâ€ï¼Œåˆ«çš„è®¾å¤‡å‹æ ¹ä¸çŸ¥é“ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä¸å¾—ä¸æå¦ä¸€ä¸ªéå¸¸ç¥å¥‡çš„ IP åœ°å€ 127.0.0.1/0.0.0.0ã€‚ä»”ç»†æƒ³ä¸€ä¸‹ï¼Œ127.0.0.1 ä¸å°±æ˜¯æ¯å°è®¾å¤‡ä¸Šéƒ½ç›¸åŒï¼Œâ€œæ‚„æ‚„è—ç€â€çš„ IP åœ°å€å—ï¼Œé™¤äº†è‡ªå·±çš„å…¶ä»–è®¾å¤‡éƒ½æ²¡åŠæ³•è®¿é—®ã€‚è¿™ä¸ªç¥å¥‡çš„ IP åœ°å€ï¼Œå«åš Loopback æ¥å£ã€‚å®ƒæ˜¯ä¸€ç§çº¯è½¯ä»¶æ€§è´¨çš„è™šæ‹Ÿæ¥å£ï¼Œå½“æœ‰è¯·æ±‚æ•°æ®åŒ…é€è¾¾åˆ° lo æ¥å£ï¼Œé‚£ä¹ˆ lo æ¥å£ä¼šå°†è¿™ä¸ªæ•°æ®åŒ…ç›´æ¥ â€œæ‰å¤´â€ï¼Œè¿”å›ç»™è¿™ä¸ªè®¾å¤‡æœ¬èº«ï¼Œè¿™å°±æ˜¯â€œç¯å›â€æ¥å£çš„ç”±æ¥ã€‚æ‰€ä»¥ï¼Œå¦‚æœå°† VIP ç»‘å®šåœ¨ lo æ¥å£ä¸Šï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥å®Œæˆâ€œåªæœ‰è‡ªå·±çŸ¥é“è¿™ä¸ª VIPï¼Œåˆ«çš„è®¾å¤‡ä¸çŸ¥é“â€å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å°† VIP ç»‘å®šåœ¨ lo æ¥å£ä¸Šï¼Œå…¶å®åªå®Œæˆäº†ä¸€åŠï¼Œåªæ˜¯åšåˆ°äº†åœ¨å¤šå°çœŸå®æœåŠ¡å™¨ä¸Šç»‘å®šç›¸åŒçš„ VIP åœ°å€ã€‚è¿˜è®°å¾—ä¸Šç¯‡æ–‡ç« ä¸­æ‰€è®²çš„ ARP åè®®å—ï¼ŒARP åè®®ä¼šé‡‡é›†åœ¨å½“å‰å±€åŸŸç½‘ä¸­ï¼Œé™¤äº†è‡ªå·±ä¹‹å¤–çš„å…¶ä»–ä¸»æœºçš„ MAC åœ°å€å’Œ IP åœ°å€çš„æ˜ å°„å…³ç³»ã€‚è€Œ VIP æ˜¯ä¸€ä¸ªä¸èƒ½è¢«åˆ«çš„è®¾å¤‡é‡‡é›†åˆ°çš„åœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å¯¹çœŸå®æœåŠ¡å™¨çš„ ARP åè®®åšä¸€äº›ä¿®æ”¹ï¼Œè®© VIP ä¸ä¼šè¢«å…¶ä»–è®¾å¤‡é‡‡é›†åˆ°ã€‚å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ä½†è¦ä¿®æ”¹è®¾å¤‡æ”¶åˆ° ARP è¯·æ±‚ä¹‹åçš„å“åº”ï¼ˆarp_ignore å‚æ•°)ï¼Œä¹Ÿè¦ä¿®æ”¹è®¾å¤‡å‘å¤–é€šå‘Š ARP çš„è¯·æ±‚ ï¼ˆarp_announce å‚æ•°ï¼‰ã€‚&lt;/p&gt;
&lt;aside&gt;
ğŸ“Œ arp_ignoreï¼šå®šä¹‰æ¥æ”¶ ARP è¯·æ±‚æ—¶çš„å“åº”çº§åˆ«  &lt;/br&gt;
0ï¼šå“åº”ä»»æ„ç½‘å¡ä¸Šæ¥æ”¶åˆ°çš„å¯¹æœ¬æœº IP åœ°å€çš„ ARP è¯·æ±‚ï¼ˆåŒ…æ‹¬ç¯å›ç½‘å¡ï¼‰ï¼Œä¸è®ºç›®çš„ IP åœ°å€æ˜¯å¦åœ¨æ¥æ”¶ç½‘å¡ä¸Š  &lt;/br&gt;
1ï¼šåªå“åº”ç›®çš„ IP åœ°å€ä¸ºæ¥æ”¶ç½‘å¡åœ°å€çš„ ARP è¯·æ±‚  &lt;/br&gt;
2ï¼šåªå“åº”ç›®çš„ IP åœ°å€ä¸ºæ¥æ”¶ç½‘å¡åœ°å€çš„ ARP è¯·æ±‚ï¼Œä¸” ARP è¯·æ±‚çš„æº IP åœ°å€å¿…é¡»å’Œæ¥æ”¶ç½‘å¡çš„åœ°å€åœ¨åŒç½‘æ®µ  &lt;/br&gt;
&lt;/aside&gt;
&lt;aside&gt;
ğŸ“Œ arp_announceï¼šå®šä¹‰å°†è‡ªå·±åœ°å€å‘å¤–é€šå‘Šæ—¶çš„é€šå‘Šçº§åˆ«  &lt;/br&gt;
0ï¼šå…è®¸ä»»æ„ç½‘å¡ä¸Šçš„ä»»æ„åœ°å€å‘å¤–é€šå‘Š  &lt;/br&gt;
1ï¼šå°½é‡ä»…å‘ç›®æ ‡ç½‘ç»œé€šå‘Šä¸å…¶ç½‘ç»œåŒ¹é…çš„åœ°å€  &lt;/br&gt;
2ï¼šä»…å‘ä¸æœ¬åœ°æ¥å£ä¸Šåœ°å€åŒ¹é…çš„ç½‘ç»œè¿›è¡Œé€šå‘Š  &lt;/br&gt;
&lt;/aside&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œarp_ignore ä¸º 1 å¹¶ä¸” arp_announce ä¸º 1 æ—¶ï¼Œlo æ¥å£ä¸Šç»‘å®šçš„ VIP å¯ä»¥è¢«è—åœ¨æœ¬æœºä¸Šï¼Œåªæœ‰è‡ªå·±çŸ¥é“ã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_dr.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_dr.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;DR&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;DR&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;çº¢è‰²è¡¨ç¤ºå‘å‡ºçš„æ•°æ®åŒ…&lt;/br&gt;
ç»¿è‰²è¡¨ç¤ºè¿”å›çš„æ•°æ®åŒ…&lt;/br&gt;
é»„è‰²è¡¨ç¤ºè´Ÿè½½å‡è¡¡å™¨ä¿®æ”¹çš„å†…å®¹&lt;/br&gt;
è™šçº¿è¡¨ç¤ºç»è¿‡ N ä¸ªä¸‹ä¸€è·³ï¼Œå³å¯ä»¥ä¸åœ¨åŒä¸€å±€åŸŸç½‘å†…&lt;/br&gt;
å®çº¿è¡¨ç¤ºåªèƒ½ â€œè·³è·ƒä¸€æ¬¡â€ï¼Œå³å¿…é¡»åœ¨åŒä¸€å±€åŸŸç½‘å†…&lt;/br&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;å½“è®¡ç®—æœºå‘å‡ºä¸€ä¸ªè¯·æ±‚çš„æ•°æ®åŒ…åˆ°è¾¾è´Ÿè½½å‡è¡¡å™¨åï¼Œè´Ÿè½½å‡è¡¡å™¨ä¿®æ”¹è¯·æ±‚æ•°æ®åŒ…çš„ { ç›®æ ‡MAC åœ°å€ }  ä¸º çœŸå®æœåŠ¡å™¨çš„ MAC åœ°å€ï¼Œå…¶ä½™ä¿¡æ¯ä¸å˜ã€‚&lt;strong&gt;è´Ÿè½½å‡è¡¡å™¨å’ŒçœŸå®æœåŠ¡å™¨å¿…é¡»åœ¨åŒä¸€å±€åŸŸç½‘å†…ï¼Œå¦åˆ™è´Ÿè½½å‡è¡¡å™¨æ— æ³•æ›¿æ¢è¯·æ±‚æ•°æ®åŒ…çš„ { ç›®æ ‡MAC åœ°å€ }  ä¸º çœŸå®æœåŠ¡å™¨çš„ MAC åœ°å€&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;çœŸå®æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚çš„æ•°æ®åŒ…ï¼Œå‘ç°è‡ªå·±æœ‰ä¸€ä¸ª â€œéšè—â€œ çš„ VIPï¼Œäºæ˜¯æ¥æ”¶è¿™ä¸ªæ•°æ®åŒ…ï¼Œå¹¶äº¤ç”±å¯¹åº”çš„ä¸Šå±‚åº”ç”¨å¤„ç†&lt;/li&gt;
&lt;li&gt;å¤„ç†å®Œæˆåï¼Œå°†å“åº”æ•°æ®åŒ…ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚æ­¤æ—¶åœ¨çœŸå®æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹ TCP è¿æ¥ä¸ºï¼šVIP â¡ï¸ CIP&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€»ç»“ä¸€ä¸‹ DR æ¨¡å¼çš„ç‰¹ç‚¹ï¼š&lt;/strong&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»…ä¿®æ”¹è¯·æ±‚æ•°æ®åŒ…çš„ã€Œç›®æ ‡ MAC åœ°å€ã€ï¼Œä½œç”¨åœ¨æ•°æ®é“¾è·¯å±‚ã€‚å› æ­¤è´Ÿè½½å‡è¡¡å™¨å¿…é¡»å’ŒçœŸå®æœåŠ¡å™¨åœ¨åŒä¸€å±€åŸŸç½‘å†…ï¼Œä¸”ä¸èƒ½å¯¹ç«¯å£è¿›è¡Œè½¬å‘&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çœŸå®æœåŠ¡å™¨ä¸­çš„ VIPï¼Œåªèƒ½è¢«è‡ªå·± â€œçœ‹è§â€ï¼Œå…¶ä»–è®¾å¤‡ä¸å¯çŸ¥ã€‚å› æ­¤ VIP å¿…é¡»ç»‘å®šåœ¨çœŸå®æœåŠ¡å™¨çš„ lo ç½‘å¡ä¸Šï¼Œå¹¶ä¸”ä¸å…è®¸å°†æ­¤ç½‘å¡ä¿¡æ¯ç»è¿‡ ARP åè®®å¯¹å¤–é€šå‘Š&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯·æ±‚çš„æ•°æ®åŒ…ç»è¿‡è´Ÿè½½å‡è¡¡å™¨åï¼Œç›´æ¥ç”±çœŸå®æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå“åº”æ•°æ®åŒ…ä¸éœ€è¦å†ç»è¿‡è´Ÿè½½å‡è¡¡å™¨&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;tun-æ¨¡å¼&#34;&gt;TUN æ¨¡å¼&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;é™¤äº†ç›´æ¥ä¿®æ”¹è¯·æ±‚æ•°æ®åŒ…çš„ç›®æ ‡ MAC åœ°å€ï¼Œåšä¸€æ¬¡ MAC åœ°å€æ¬ºéª—ä¹‹å¤–ï¼Œè¿˜æœ‰æ²¡æœ‰å…¶ä»–æ–¹å¼èƒ½å¤Ÿå°†å“åº”æ•°æ®åŒ…ç”±çœŸå®æœåŠ¡å™¨ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯å‘¢ï¼Ÿçœ‹çœ‹ VPN æ˜¯æ€ä¹ˆèƒ½å¤Ÿæ”¯æŒä½ è¿œç¨‹åŠå…¬çš„å§ï½&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡ï¼Œå¦‚æœçœŸå®æœåŠ¡å™¨ç›´æ¥å°†å“åº”æ•°æ®åŒ…è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œé‚£ä¹ˆçœŸå®æœåŠ¡å™¨å¿…é¡»æœ‰ä¸€ä¸ª â€œéšè—â€ çš„ VIPï¼Œå³é…ç½®åœ¨ lo ç½‘å¡ä¸Šå¹¶ä¸”ä¸å…è®¸æ­¤ VIP é€šè¿‡ ARP åè®®å¯¹å¤–é€šå‘Šã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_tunnel.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_tunnel.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;TUN&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;TUN&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;çº¢è‰²è¡¨ç¤ºå‘å‡ºçš„æ•°æ®åŒ…&lt;/br&gt;
ç»¿è‰²è¡¨ç¤ºè¿”å›çš„æ•°æ®åŒ…&lt;/br&gt;
é»„è‰²è¡¨ç¤ºè´Ÿè½½å‡è¡¡å™¨ä¿®æ”¹çš„å†…å®¹&lt;/br&gt;
è™šçº¿è¡¨ç¤ºç»è¿‡ N ä¸ªä¸‹ä¸€è·³ï¼Œå³å¯ä»¥ä¸åœ¨åŒä¸€å±€åŸŸç½‘å†…&lt;/br&gt;
å®çº¿è¡¨ç¤ºåªèƒ½ â€œè·³è·ƒä¸€æ¬¡â€ï¼Œå³å¿…é¡»åœ¨åŒä¸€å±€åŸŸç½‘å†…&lt;/br&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;å½“è®¡ç®—æœºå‘å‡ºä¸€ä¸ªè¯·æ±‚çš„æ•°æ®åŒ…åˆ°è¾¾è´Ÿè½½å‡è¡¡å™¨åï¼Œè´Ÿè½½å‡è¡¡å™¨ä¸æ”¹å˜æºæ•°æ®åŒ…ï¼Œè€Œæ˜¯åœ¨æºæ•°æ®åŒ…ä¸Šæ–°å¢ä¸€å±‚ IP é¦–éƒ¨ { åˆ†å‘ IPã€ç«¯å£å·ã€MAC åœ°å€ } â¡ï¸ { çœŸå®æœåŠ¡å™¨ IPã€ç«¯å£å·ã€MAC åœ°å€ }&lt;/li&gt;
&lt;li&gt;çœŸå®æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚çš„æ•°æ®åŒ…åï¼Œå°†æœ€å¤–å±‚å°è£…çš„ IP é¦–éƒ¨å»æ‰ï¼Œå‘ç°è¿˜æœ‰ä¸€å±‚ IP é¦–éƒ¨ï¼Œå¹¶ä¸”ç›®æ ‡ IP åœ°å€èƒ½å¤Ÿå’Œ lo ä¸Šçš„åœ°å€åŒ¹é…ï¼Œäºæ˜¯æ”¶ä¸‹è¯·æ±‚æ•°æ®åŒ…ï¼Œå¹¶äº¤ç”±å¯¹åº”çš„ä¸Šå±‚åº”ç”¨å¤„ç†&lt;/li&gt;
&lt;li&gt;å¤„ç†å®Œæˆåï¼Œå°†å“åº”æ•°æ®åŒ…ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚æ­¤æ—¶åœ¨çœŸå®æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹ TCP è¿æ¥ä¸ºï¼šVIP â¡ï¸ CIP&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“ä¸€ä¸‹ TUN æ¨¡å¼çš„ç‰¹ç‚¹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ”¹å˜è¯·æ±‚æ•°æ®åŒ…ï¼Œè€Œæ˜¯åœ¨è¯·æ±‚æ•°æ®åŒ…ä¸Šæ–°å¢ä¸€å±‚ IP é¦–éƒ¨ä¿¡æ¯ã€‚å› æ­¤è´Ÿè½½å‡è¡¡å™¨ä¸èƒ½å¯¹ç«¯å£è¿›è¡Œè½¬å‘ï¼Œä½†å¯ä»¥å’ŒçœŸå®æœåŠ¡å™¨ä¸åœ¨åŒä¸€å±€åŸŸç½‘å†…ï¼Œä¸”çœŸå®æœåŠ¡å™¨éœ€è¦æ”¯æŒèƒ½å¤Ÿè§£æä¸¤å±‚ IP é¦–éƒ¨ä¿¡æ¯ï¼Œå³éœ€è¦æ”¯æŒâ€œIP Tunnelingâ€æˆ–â€œIP Encapsulationâ€åè®®&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çœŸå®æœåŠ¡å™¨ä¸­çš„ VIPï¼Œåªèƒ½è¢«è‡ªå·± â€œçœ‹è§â€ï¼Œå…¶ä»–è®¾å¤‡ä¸å¯çŸ¥ã€‚å› æ­¤ VIP å¿…é¡»ç»‘å®šåœ¨çœŸå®æœåŠ¡å™¨çš„ lo ç½‘å¡ä¸Šï¼Œå¹¶ä¸”ä¸å…è®¸å°†æ­¤ç½‘å¡ä¿¡æ¯ç»è¿‡ ARP åè®®å¯¹å¤–é€šå‘Š&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯·æ±‚çš„æ•°æ®åŒ…ç»è¿‡è´Ÿè½½å‡è¡¡å™¨åï¼Œç›´æ¥ç”±çœŸå®æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå“åº”æ•°æ®åŒ…ä¸éœ€è¦å†ç»è¿‡è´Ÿè½½å‡è¡¡å™¨&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;åœ¨ DR å’Œ TUN æ¨¡å¼ä¸­ï¼Œè´Ÿè½½å‡è¡¡å™¨åªè½¬å‘äº†è¯·æ±‚æ•°æ®åŒ…ï¼Œå“åº”æ•°æ®åŒ…ä¸ç»è¿‡è´Ÿè½½å‡è¡¡å™¨ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚è§£å†³äº†åœ¨é€šå¸¸æƒ…å†µä¸‹å“åº”æ•°æ®åŒ…æ¯”è¯·æ±‚æ•°æ®åŒ…å¤§ï¼Œå¦‚æœè¯·æ±‚å’Œå“åº”æ•°æ®åŒ…éƒ½ç»è¿‡è´Ÿè½½å‡è¡¡å™¨ï¼Œåœ¨é«˜å¹¶å‘ä¸‹å¯èƒ½æˆä¸ºç³»ç»Ÿç“¶é¢ˆçš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ®æˆ‘ä»¬çš„æ¨å¯¼è¿‡ç¨‹ï¼Œå¯ä»¥è½»æ˜“åœ°å¾—å‡ºå„ç§æ¨¡å¼çš„ç‰¹ç‚¹å’Œå®ƒä»¬è¦è§£å†³çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;NAT æ¨¡å¼ï¼Œé€šè¿‡ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œç›®æ ‡ IP åœ°å€ã€å’Œ ã€Œæº IP åœ°å€ã€ï¼Œå°†è¯·æ±‚è´Ÿè½½åˆ°å¤šå°çœŸå®æœåŠ¡å™¨ï¼Œæ˜¯å››å±‚è´Ÿè½½å‡è¡¡æ¨¡å¼ä¸­æœ€åŸºç¡€çš„è´Ÿè½½æ–¹å¼ã€‚å› ä¸ºå®ƒæ˜¯å¯¹ IP åœ°å€å±‚é¢çš„ä¿®æ”¹ï¼Œä½œç”¨åœ¨ç½‘ç»œå±‚ï¼Œæ‰€ä»¥å¯ä»¥å¯¹ç«¯å£è¿›è¡Œæ˜ å°„ã€‚çœŸå®æœåŠ¡å™¨è¿”å›çš„å“åº”æ•°æ®åŒ…å¿…é¡»ç»è¿‡è´Ÿè½½å‡è¡¡å™¨ï¼Œæ‰€ä»¥è¦æ±‚çœŸå®æœåŠ¡å™¨çš„é»˜è®¤ç½‘å…³æ˜¯è´Ÿè½½å‡è¡¡å™¨ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;FULLNAT æ¨¡å¼ï¼Œæ˜¯å¯¹ NAT æ¨¡å¼çš„ä¸€ç§æ¼”è¿›ã€‚é€šè¿‡åŒæ—¶ä¿®æ”¹ã€Œæº IP åœ°å€ã€å’Œã€Œç›®æ ‡ IP åœ°å€ã€ï¼Œçªç ´ NAT æ¨¡å¼ä¸­çœŸå®æœåŠ¡å™¨çš„é»˜è®¤ç½‘å…³å¿…é¡»æ˜¯è´Ÿè½½å‡è¡¡å™¨çš„é™åˆ¶ã€‚ä½†æ˜¯ç”±äºåŒæ—¶ä¿®æ”¹äº†ã€Œæº IP åœ°å€ã€å’Œã€Œç›®æ ‡ IP åœ°å€ã€ï¼ŒçœŸå®æœåŠ¡å™¨å»ºç«‹çš„çœŸå®è¿æ¥å’Œå®¢æˆ·ç«¯æ¯«æ— å…³ç³»ï¼Œæ‰€ä»¥ä¼šä¸¢å¤±å®¢æˆ·ç«¯çš„ä¿¡æ¯ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DR æ¨¡å¼ï¼Œæ˜¯å¯¹ NAT æ¨¡å¼çš„å¦ä¸€ç§æ¼”è¿›ã€‚ç”±äºçœŸå®è¯·æ±‚ä¸­å“åº”æ•°æ®åŒ…æ¯”è¯·æ±‚æ•°æ®åŒ…å¤§å¾ˆå¤šçš„ç‰¹ç‚¹ï¼Œåœ¨é«˜å¹¶å‘ä¸‹ä¼šæˆä¸ºç³»ç»Ÿçš„ç“¶é¢ˆï¼Œäºæ˜¯å°†å“åº”æ•°æ®åŒ…ç›´æ¥ç”±çœŸå®æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ä½¿ç”¨ MAC åœ°å€æ¬ºéª—æ¥è¾¾åˆ°æ­¤ç›®çš„ï¼Œä½œç”¨äºæ•°æ®é“¾è·¯å±‚ï¼Œæ‰€ä»¥ä¸èƒ½å¯¹ç«¯å£æ˜ å°„ã€‚å¹¶ä¸”åœ¨çœŸå®æœåŠ¡å™¨ä¸Šï¼Œå¿…é¡»æœ‰ä¸€ä¸ªä»…è‡ªå·±å¯è§çš„ â€œéšè—â€ VIPã€‚åœ¨ç½‘ç»œä¸­ï¼ŒçœŸå®çš„ VIP ç»‘å®šåœ¨è´Ÿè½½å‡è¡¡å™¨ä¸Šï¼Œç”¨æ¥æ¥æ”¶å®¢æˆ·ç«¯çš„çœŸå®è¯·æ±‚æ•°æ®åŒ…ã€‚è€Œ â€œéšè—â€ çš„ VIP ç»‘å®šåœ¨çœŸå®æœåŠ¡å™¨çš„ lo æ¥å£ä¸Šï¼Œç”¨æ¥æ¬ºéª—è‡ªå·±å¯ä»¥æ­£å¸¸æ¥æ”¶ç›®æ ‡åœ°å€æ˜¯ VIP çš„æ•°æ®åŒ…ã€‚æ‰€ä»¥çœŸå®æœåŠ¡å™¨å’Œè´Ÿè½½å‡è¡¡å™¨å¿…é¡»åœ¨åŒä¸€å±€åŸŸç½‘ä¸­ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TUN æ¨¡å¼ï¼Œæ˜¯å¯¹ DR æ¨¡å¼çš„ä¸€ç§æ¼”è¿›ã€‚çªç ´ DR æ¨¡å¼ä¸­çœŸå®æœåŠ¡å™¨å’Œè´Ÿè½½å‡è¡¡å™¨å¿…é¡»åœ¨åŒä¸€å±€åŸŸç½‘ä¸­çš„é™åˆ¶ã€‚TUN æ¨¡å¼ä¸ä¼šå¯¹æºæ•°æ®åŒ…è¿›è¡Œä¿®æ”¹ï¼Œè€Œæ˜¯åœ¨æºæ•°æ®åŒ…ä¸Šé¢å¤–æ–°å¢ä¸€æ¡ IP é¦–éƒ¨ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸èƒ½å¯¹ç«¯å£æ˜ å°„ï¼Œä¸”è¦æ±‚çœŸå®æœåŠ¡å™¨å¿…é¡»èƒ½å¤Ÿå¸è½½æ‰ä¸¤å±‚ IP é¦–éƒ¨ä¿¡æ¯ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ğŸ’¡ å›é¡¾ä¹‹å‰çš„å°æ€è€ƒé¢˜ï¼šä¸ºä»€ä¹ˆåœ¨è¯´çœŸå®æœåŠ¡å™¨èƒ½å¤Ÿæ­£å¸¸æ¥æ”¶è´Ÿè½½å‡è¡¡å™¨è½¬å‘çš„æ•°æ®åŒ…çš„å¿…è¦æ¡ä»¶æ—¶ï¼Œæ²¡æœ‰å¸¦ä¸Š MAC åœ°å€ï¼Ÿ&lt;/p&gt;
  &lt;aside&gt;
  ğŸ“Œ åœ¨ç½‘ç»œé€šä¿¡éƒ¨åˆ†ä»‹ç» ARP åè®®å’Œä¸‹ä¸€è·³æœºåˆ¶æ—¶ï¼Œæˆ‘ä»¬æåˆ°æ•°æ®åŒ…åœ¨ç½‘ç»œä¸­çš„è½¬å‘å’Œå¿«é€’ä¼ é€ä¸­çš„é©¿ç«™ç±»ä¼¼ï¼Œæ¯ä¸€æ¬¡æ•°æ®åŒ…çš„å‘é€ï¼Œä¼šä¸æ–­åœ°æ‰¾åˆ° â€œä¸‹ä¸€ä¸ªç›®çš„åœ°â€ çš„ MAC åœ°å€ã€‚æ‰€ä»¥ï¼Œä½†å‡¡æ¶‰åŠåˆ°ç‰©ç†ç«¯å£çš„å˜è¿ï¼Œéƒ½æ¶‰åŠåˆ°æº MAC åœ°å€çš„å˜åŒ–ï¼Œè¿™ä¸ªå˜åŒ–æ˜¯ IP é€šä¿¡çš„ç‰¹æ€§ï¼Œè€Œå¹¶ä¸æ˜¯è´Ÿè½½å‡è¡¡çš„ç‰¹ç‚¹ã€‚
  &lt;/aside&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;åœ¨å¯¹è´Ÿè½½å‡è¡¡çš„å„ä¸ªæ¨¡å¼æœ‰ä¸€å®šçš„äº†è§£ä¹‹åï¼Œä¸‹ä¸€ç¯‡æˆ‘ä»¬æ¥å…·ä½“å®è·µå’Œé…ç½®ï½&lt;/p&gt;
</description>
        </item>
        <item>
        <title>æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆä¸€ï¼‰NATã€FULLNAT æ¨¡å‹åŸç†</title>
        <link>https://boxtsecond.github.io/zh-cn/dev/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA-lvs-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E4%B8%80natfullnat-%E6%A8%A1%E5%9E%8B%E5%8E%9F%E7%90%86/</link>
        <pubDate>Tue, 05 Sep 2023 14:52:03 +0800</pubDate>
        
        <guid>https://boxtsecond.github.io/zh-cn/dev/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA-lvs-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E4%B8%80natfullnat-%E6%A8%A1%E5%9E%8B%E5%8E%9F%E7%90%86/</guid>
        <description>&lt;p&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ç³»åˆ—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆä¸€ï¼‰NATã€FULLNAT æ¨¡å‹åŸç†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸¤å°è®¡ç®—æœºå¦‚ä½•åœ¨äº’è”ç½‘ä¸­é€šä¿¡&lt;/li&gt;
&lt;li&gt;LVS è´Ÿè½½å‡è¡¡
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œæº IP åœ°å€ã€æˆ–ã€Œç›®æ ‡ IP åœ°å€ã€
&lt;ul&gt;
&lt;li&gt;NAT æ¨¡å¼&lt;/li&gt;
&lt;li&gt;FULLNAT æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆäºŒï¼‰DRã€TUN æ¨¡å‹åŸç†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;LVS è´Ÿè½½å‡è¡¡
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œç›®æ ‡ MAC åœ°å€ã€
&lt;ul&gt;
&lt;li&gt;DR æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€šè¿‡äºŒæ¬¡å°è£…æ•°æ®åŒ…çš„ã€ŒIP æŠ¥æ–‡ã€
&lt;ul&gt;
&lt;li&gt;TUN æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆä¸‰ï¼‰å®æ“ NATã€DR æ¨¡å‹ã€æ·±å…¥æµ…å‡º LVS è´Ÿè½½å‡è¡¡ï¼ˆå››ï¼‰å®æ“ TUNNEL æ¨¡å‹ã€Keepalived DR æ¨¡å‹çš„é«˜å¯ç”¨&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ UCloud äº‘ä¸»æœºå®æ“å„ä¸ªæ¨¡å‹&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ Keepalived å®ç° LVS-DR çš„é«˜å¯ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;LVSï¼ˆLinux Virtual Serverï¼‰æ˜¯ä¸€ä¸ªè™šæ‹ŸæœåŠ¡å™¨é›†ç¾¤ç³»ç»Ÿã€‚å·¥ä½œåœ¨ OSI æ¨¡å‹çš„ä¼ è¾“å±‚ï¼Œå³å››å±‚è´Ÿè½½å‡è¡¡ã€‚LVS æœ¬èº«å®ç°äº† NATã€DRã€TUN æ¨¡å‹ï¼Œè¿™äº›æ¨¡å‹ä»…åšæ•°æ®åŒ…çš„è½¬å‘ï¼Œè€Œä¸ä¼šä¸å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œæˆæœ¬ä½æ•ˆç‡é«˜ã€‚FULLNAT åŸºäº NAT å®ç°ï¼ŒLVS æœ¬èº«ä¸æ”¯æŒï¼Œéœ€è¦é¢å¤–å¯¹å†…æ ¸æ‰“è¡¥ä¸åæ‰èƒ½ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;aside&gt;
ğŸ“Œ æœ¬ç³»åˆ—æŒ‰ç…§è´Ÿè½½å‡è¡¡å™¨å¯¹æ•°æ®åŒ…çš„å¤„ç†æ–¹å¼åˆ†ç±»ï¼Œä»è®¡ç®—æœºé—´é€šä¿¡çš„è§’åº¦å‡ºå‘ï¼Œæµ…è°ˆ NATã€FULLNATã€DRã€TUN æ¨¡å‹çš„å®ç°åŸç†ã€‚
&lt;/aside&gt;
&lt;h2 id=&#34;ä¸¤å°è®¡ç®—æœºå¦‚ä½•åœ¨äº’è”ç½‘ä¸­é€šä¿¡&#34;&gt;ä¸¤å°è®¡ç®—æœºå¦‚ä½•åœ¨äº’è”ç½‘ä¸­é€šä¿¡&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;åœ¨äº†è§£ LVS è´Ÿè½½å‡è¡¡ä¹‹å‰ï¼Œå…ˆè¦ææ¸…æ¥šä¸¤å°è®¡ç®—æœºå¦‚ä½•åœ¨äº’è”ç½‘ä¸­é€šä¿¡ã€‚èŒ«èŒ«äº’è”ç½‘ä¸­ï¼Œä¸¤å°è®¡ç®—æœºå¦‚ä½•æ‰èƒ½æ‰¾åˆ°å¯¹æ–¹ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ï¼Œå¿«é€’æ˜¯å¦‚ä½•è¢«å¿«é€’å°å“¥å®Œç¾åœ°é€åˆ°ä½ æ‰‹ä¸Šçš„ã€‚æ ¹æ®ä½ çš„åœ°å€ï¼Œå¿«é€’å…ˆé€åˆ°ä½ æ‰€åœ¨çš„çœå¸‚åŒºï¼Œæ¥ç€åœ¨å½“å‰çœå¸‚åŒºæ‰¾åˆ°ä½ çš„é—¨ç‰Œå·ï¼Œæœ€åæ ¹æ®é—¨ç‰Œå·å’Œå§“åï¼Œå†äº²æ‰‹æŠŠå¿«é€’äº¤ç»™ä½ ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤å°è®¡ç®—æœºåœ¨äº’è”ç½‘ä¸­çš„é€šä¿¡ä¹Ÿæ˜¯å¦‚æ­¤ã€‚é¦–å…ˆéœ€è¦çŸ¥é“åŒæ–¹çš„ IP åœ°å€ï¼Œå³çœå¸‚åŒºï¼Œå…¶æ¬¡éœ€è¦çŸ¥é“åŒæ–¹çš„ MAC åœ°å€ï¼Œå³é—¨ç‰Œå·ã€‚MAC åœ°å€æ ‡å¿—ç€å”¯ä¸€çš„è®¡ç®—æœºã€‚åœ¨åŒä¸€å°è®¡ç®—æœºä¸Šï¼Œå¯èƒ½æœ‰å¤šä¸ªä¸åŒçš„æœåŠ¡ï¼Œå¦‚ä½•èƒ½åƒå¿«é€’å°å“¥æŒ‰ç…§å§“åæ‰¾åˆ°ä½ ä¸€æ ·ï¼Œåœ¨è®¡ç®—æœºä¸Šæ‰¾åˆ°å¯¹åº”çš„æœåŠ¡å‘¢ï¼Ÿæ²¡é”™ï¼Œå°±æ˜¯æŒ‰ç…§ç«¯å£å·ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·ï¼Œé€šä¿¡ä¸­æ¯å°è®¡ç®—æœºéœ€è¦æä¾›çš„ä¿¡æ¯å°±å¾ˆæ¸…æ™°äº†ï¼Œå³ IP åœ°å€ã€MAC åœ°å€ã€ç«¯å£å·ã€‚æ€»ç»“ä¸€ä¸‹ï¼Œé€šä¿¡å¿…éœ€çš„å…­ä¸ªè¦ç´ å°±æ˜¯ï¼Œæº IP åœ°å€ã€ç«¯å£å·ã€æº MAC åœ°å€ï¼Œç›®æ ‡ IP åœ°å€ã€ç«¯å£å·ã€ç›®æ ‡ MAC åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_1.svg&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_1.svg&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;é€šä¿¡&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;é€šä¿¡&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å‡è®¾è®¡ç®—æœº A å’Œè®¡ç®—æœº B åœ¨ä¸Šè¿°çš„ç½‘ç»œæ‹“æ‰‘å›¾ï¼ˆä¸åœ¨åŒä¸€å±€åŸŸç½‘ï¼‰ä¸­ã€‚å¯ä»¥å¾ˆæ¸…æ™°åœ°çœ‹åˆ° è®¡ç®—æœº A å’Œ è®¡ç®—æœº B é€šä¿¡éœ€è¦äº”ä¸ªæ­¥éª¤ï¼Œå…¶ä¸­ â‘ â‘¡ å’Œ â‘£â‘¤ çš„åŸç†ç›¸åŒã€‚ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å…·ä½“çš„æ¯ä¸ªæ­¥éª¤åœ¨è®¡ç®—æœºçš„ä¸–ç•Œä¸­æ˜¯å¦‚ä½•å®ç°çš„ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆ A å’Œ B çš„ IP åœ°å€å’Œç«¯å£å·æ˜¯å·²çŸ¥çš„ï¼Œå³ä¸€ä¸ªæ•°æ®åŒ…ä»å“ªæ¥è¦å‘å¾€å“ªå»ã€‚æ‰€ä»¥ç°åœ¨çš„é—®é¢˜æ˜¯ï¼šA å¦‚ä½•èƒ½çŸ¥é“ B çš„ MAC åœ°å€ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ A ä¿å­˜ç½‘ç»œä¸­å…¨éƒ¨è®¾å¤‡çš„ MAC åœ°å€ï¼Œåœ¨å‘é€æ—¶æŸ¥è¯¢ä¸€ä¸‹ï¼Œè¿™æ ·å°±èƒ½å¾—åˆ° B çš„ MAC åœ°å€ã€‚ä½†æ˜¯ç½‘ç»œä¸­çš„è®¾å¤‡æœ‰å‡ åäº¿ä¸ªï¼Œè¿˜åœ¨ä¸æ–­åœ°å¢é•¿ï¼Œæ˜¾ç„¶è¿™ç§æ–¹å¼æ˜¯ä¸å¯å–çš„ã€‚å¦‚æœæŒ‰ç…§å¿«é€’å‘é€è¿‡ç¨‹ä¸­ï¼Œåœ¨æ¯ä¸ªé©¿ç«™ä¹‹é—´è¿›è¡Œè½¬ç§»ï¼Œè¿™æ ·åªéœ€è¦çŸ¥é“è¯¥å‘å¾€çš„ä¸‹ä¸€ç›®çš„åœ°åœ¨å“ªé‡Œï¼Œæœ€ç»ˆä¹Ÿèƒ½å°†å¿«é€’æˆåŠŸåœ°äº¤åˆ°ä½ çš„æ‰‹ä¸Šã€‚åœ¨å®é™…ç½‘ç»œä¸­å‘é€æ•°æ®åŒ…ä¹Ÿæ˜¯è¿™æ ·ï¼Œç°åœ¨çš„ç›®æ ‡å°±æ˜¯ç¡®å®š â€œä¸‹ä¸€ä¸ªç›®çš„åœ°â€ çš„ MAC åœ°å€ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ­¥éª¤ â‘ â‘¡ï¼šå‘é€æ•°æ®åŒ…è‡³ç½‘å…³&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;A ä¸çŸ¥é“ B çš„ MAC åœ°å€ï¼Œä¸” A å’Œ B ä¹Ÿä¸åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ä¸­ã€‚è¿™æ—¶ A ä¼šæ ¹æ® ARP åè®®å…ˆå‘å‡ºä¸€ä¸ªå¹¿æ’­åŒ…ï¼Œå³ç›®æ ‡ MAC åœ°å€æ˜¯ FF:FF:FF:FF:FF:FF çš„æ•°æ®åŒ…ã€‚å½“ äº¤æ¢æœº1 æ”¶åˆ°è¿™ä¸ªå¹¿æ’­åŒ…ä¹‹åï¼Œä¼šå°†è¿™ä¸ªæ•°æ®åŒ…è½¬å‘ç»™å…¶ä»–ç«¯å£ï¼Œå¹¶ä¸”è®°å½• A çš„ MAC åœ°å€å’Œäº¤æ¢æœºç«¯å£ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œåç»­å†çœ‹åˆ°è¿™ä¸ª MAC åœ°å€ï¼Œå°±çŸ¥é“è¯¥ä»å“ªä¸ªç«¯å£è½¬å‘å‡ºå»ã€‚å½“ è·¯ç”±å™¨1 æ”¶åˆ°å¹¿æ’­åŒ…åï¼Œä¼šå°†è‡ªå·±çš„ MAC åœ°å€è¿”å›ã€‚A æ¥æ”¶åˆ°è¿”å›åï¼Œå°±çŸ¥é“ â€œä¸‹ä¸€ä¸ªç›®çš„åœ°â€ çš„ MAC åœ°å€äº†ã€‚A é‡æ–°å‘é€æ•°æ®åŒ…ï¼Œå°†ç›®æ ‡ MAC åœ°å€å¡«å†™ä¸º è·¯ç”±å™¨1 çš„ MAC åœ°å€ï¼Œå¹¶åœ¨æœ¬åœ°çš„ç¼“å­˜è¡¨ä¸­è®°å½•è¿”å›çš„ MAC åœ°å€ã€‚&lt;/p&gt;
&lt;aside&gt;
ğŸ’¡ æŸ¥çœ‹å½“å‰è®¾å¤‡ç¼“å­˜è¡¨é‡Œå·²å­˜çš„ MAC åœ°å€ï¼šarp -a
&lt;/aside&gt;
&lt;aside&gt;
ğŸ“Œ ARP åè®®çš„ç›®çš„å°±æ˜¯æ‰¾åˆ°â€œä¸‹ä¸€ä¸ªç›®çš„åœ°â€çš„ MAC åœ°å€ï¼Œå³ IP åœ°å€å’Œ MAC åœ°å€ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚
å½“ä¸¤å°è®¾å¤‡åŒå¤„äºä¸€ä¸ªå±€åŸŸç½‘æ—¶ï¼Œâ€œä¸‹ä¸€ä¸ªç›®çš„åœ°â€ å°±æ˜¯ç›®æ ‡è®¾å¤‡çš„ MAC åœ°å€ï¼Œå½“ä¸¤å°è®¾å¤‡ä¸å¤„äºåŒä¸€ä¸ªå±€åŸŸç½‘æ—¶ï¼Œâ€œä¸‹ä¸€ä¸ªç›®çš„åœ°â€ å°±æ˜¯ç½‘å…³çš„ MAC åœ°å€ã€‚
&lt;/aside&gt;
&lt;blockquote&gt;
&lt;p&gt;æ­¥éª¤ â‘¢ï¼šç½‘å…³é—´è·³è½¬&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç»è¿‡æ­¥éª¤ â‘ â‘¡ï¼Œæ­¤æ—¶ è·¯ç”±å™¨1 æ”¶åˆ°çš„æ•°æ®åŒ…ä¸º { A_IPã€PORTã€A_MAC }  â¡   { B_IPã€PORTã€è·¯ç”±å™¨1_MAC } ã€‚æ”¶åˆ°æ•°æ®åŒ…åï¼Œè·¯ç”±å™¨1 æŸ¥çœ‹è‡ªå·±çš„è·¯ç”±è¡¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;aside&gt;
ğŸ’¡ æŸ¥çœ‹å½“å‰è®¾å¤‡è®¾ç½®çš„è·¯ç”±è¡¨ï¼šroute -n
&lt;/aside&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/route.png&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/route.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;route -n&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;route -n&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è·¯ç”±å™¨1 ä¼šå°† B_IP ä¸ è·¯ç”±è¡¨ä¸­æ¯æ¡è®°å½•çš„å­ç½‘æ©ç ï¼ˆGenmaskï¼‰åšæŒ‰ä½ä¸è¿ç®—ã€‚å¦‚æœå¾—åˆ°çš„ç»“æœå’Œç›®çš„ç½‘ç»œï¼ˆDestinationï¼‰ç›¸åŒï¼Œé‚£ä¹ˆ â€œä¸‹ä¸€ä¸ªç›®çš„åœ°â€œ çš„ MAC åœ°å€ï¼Œå°±æ˜¯é…ç½®çš„ç½‘å…³ï¼ˆGatewayï¼‰çš„ MAC åœ°å€ï¼Œè¿™ç§æ‰¾åˆ°ç›¸é‚»ç½‘ç»œçš„æ–¹å¼å«åš â€œä¸‹ä¸€è·³æœºåˆ¶â€ã€‚å¦‚æœç½‘å…³çš„åœ°å€ä¸º 0.0.0.0ï¼Œè¯´æ˜å¯ä»¥åœ¨å±€åŸŸç½‘ä¸­ç›´æ¥é€šä¿¡ï¼Œä¸éœ€è¦ â€œä¸‹ä¸€è·³â€ã€‚è‡³æ­¤ï¼Œå†æ¬¡æ‰¾åˆ°äº† â€œä¸‹ä¸€ä¸ªç›®çš„åœ°â€ çš„ MAC åœ°å€ï¼Œå³ è·¯ç”±å™¨2 çš„ MAC åœ°å€ã€‚æ­¤æ—¶ è·¯ç”±å™¨2 æ”¶åˆ°çš„æ•°æ®åŒ…ä¸º { A_IPã€PORTã€è·¯ç”±å™¨1_MAC }  â¡   { B_IPã€PORTã€è·¯ç”±å™¨2_MAC } ã€‚æ­¥éª¤ â‘£â‘¤ å’Œ â‘ â‘¡ çš„åŸç†ç›¸åŒï¼Œåœ¨è¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚&lt;/p&gt;
&lt;aside&gt;
ğŸ“Œ ä¸‹ä¸€è·³çš„ç›®çš„å°±æ˜¯æ‰¾åˆ°â€œä¸‹ä¸€ä¸ªç›®çš„åœ°â€ï¼Œå³ä¸‹ä¸€æ­¥è¯¥åˆ°è¾¾å“ªé‡Œï¼Œä¾§é‡ â€œè·¯çº¿â€ çš„é€‰æ‹©ï¼Œå¹¶ç”±æ­¤è·å–åˆ°å¯¹åº”çš„ MAC åœ°å€ï¼Œç»§ç»­ä¼ é€æ•°æ®åŒ…ã€‚
&lt;/aside&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€»ç»“ä¸€ä¸‹ï¼š&lt;/strong&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨ ARP åè®®æ‰¾åˆ°ç½‘å…³å‡ºå£æˆ–åŒä¸€å±€åŸŸç½‘å†…è®¾å¤‡çš„ MAC åœ°å€&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒ‰ç…§è·¯ç”±è¡¨çš„æ¯æ¡è§„åˆ™å’Œ ç›®æ ‡ IP åœ°å€åšæŒ‰ä½ä¸è¿ç®—ï¼Œæ‰¾åˆ°ç›¸é‚»ç½‘å…³å…¥å£çš„ MAC åœ°å€&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;â€œä¸‹ä¸€ä¸ªç›®çš„åœ°â€ å’Œå½“å‰åœ°å€éƒ½ä»…ä»…ç›¸é‚»ä¸€æ­¥ï¼Œä¸”æ¯æ¬¡ â€œè·³è·ƒâ€ åçš„æº MAC åœ°å€ å’Œ ç›®æ ‡ MAC åœ°å€éƒ½ä¼šå‘ç”Ÿå¯¹åº”çš„æ›¿æ¢&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åŒ…ä¸­ï¼ŒIP åœ°å€æŒ‡æ˜èµ·ç‚¹ç»ˆç‚¹ï¼ŒMAC åœ°å€æŒ‡æ˜è·³è·ƒçš„èŠ‚ç‚¹ï¼Œç«¯å£å·æŒ‡æ˜å¯¹åº”çš„åº”ç”¨æœåŠ¡&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“ç„¶ï¼Œå…‰æ˜¯æ‰¾åˆ°å¯¹æ–¹è¿˜ä¸å¤Ÿï¼Œè¿˜éœ€è¦ä¸€ä¸ªçº¦å®šçš„äº¤æµæ–¹å¼ï¼Œå¹³æ—¶æˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„å„ç§åè®®ï¼Œéƒ½æ˜¯è®¡ç®—æœºã€Œçº¦å®šçš„äº¤æµæ–¹å¼ã€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;lvs-è´Ÿè½½å‡è¡¡&#34;&gt;LVS è´Ÿè½½å‡è¡¡&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;éšç€ä½¿ç”¨äº’è”ç½‘çš„è®¾å¤‡ä¸æ–­å¢é•¿ï¼ŒæœåŠ¡ç«¯å¯¹åº”æ¥æ”¶åˆ°çš„ HTTP è¯·æ±‚æ›´æ˜¯å‘ˆæŒ‡æ•°å‹çš„å¢é•¿ã€‚å½“ä¸€å°æœåŠ¡å™¨æ— æ³•æ‰¿è½½éå¸¸å¤§çš„è¯·æ±‚é‡æ—¶ï¼Œä½¿ç”¨å¤šå°æœåŠ¡å™¨æ¥åˆ†æ‘Šè¯·æ±‚ã€‚å°†è¯·æ±‚åˆ†æ‘Šç»™å¤šå°æœåŠ¡å™¨çš„è¡Œä¸ºï¼Œå°±ç§°ä¹‹ä¸ºè´Ÿè½½å‡è¡¡ã€‚&lt;/p&gt;
&lt;p&gt;ä»ç½‘ç»œä¸­è®¡ç®—æœºé€šä¿¡çš„è§’åº¦ï¼Œè€Œéä½¿ç”¨æ›´ä¸Šå±‚çš„åº”ç”¨ï¼ˆå¦‚ Nginxï¼‰å‡ºå‘ï¼Œæ­å»ºå››å±‚è´Ÿè½½å‡è¡¡å™¨åï¼Œæ•°æ®åŒ…çš„å‘é€é“¾è·¯ä¸ºï¼šCIP â¡  VIP â¡  DIP â¡  RIPï¼Œå³ å®¢æˆ·ç«¯ IP â¡  è™šæ‹Ÿ IP â¡  åˆ†å‘ IP â¡  çœŸå®æœåŠ¡å™¨ IPã€‚å¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œåªéœ€è¦çŸ¥é“è¯·æ±‚åˆ°è¾¾çš„åœ°å€æ˜¯ VIPï¼Œä¸éœ€è¦è€ƒè™‘è´Ÿè½½ï¼Œå³ CIP â¡  VIP æ˜¯å›ºå®šçš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ‰€ä»¥è´Ÿè½½å‡è¡¡å™¨è¦åšçš„äº‹æƒ…ï¼Œå°±æ˜¯å°† CIP å‘é€åˆ° VIP çš„æ•°æ®åŒ…ï¼Œç»ç”± DIP è½¬å‘ç»™ RIPï¼ŒæœåŠ¡å“åº”åå†å°†å“åº”çš„æ•°æ®åŒ…è¿”å›ç»™ CIPã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;nat-æ¨¡å¼&#34;&gt;NAT æ¨¡å¼&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_2.svg&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_2.svg&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;NAT&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;NAT&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;çº¢è‰²è¡¨ç¤ºå‘å‡ºçš„æ•°æ®åŒ…&lt;/br&gt;
ç»¿è‰²è¡¨ç¤ºè¿”å›çš„æ•°æ®åŒ…&lt;/br&gt;
é»„è‰²è¡¨ç¤ºè´Ÿè½½å‡è¡¡å™¨ä¿®æ”¹çš„å†…å®¹&lt;/br&gt;
è™šçº¿è¡¨ç¤ºç»è¿‡ N ä¸ªä¸‹ä¸€è·³ï¼Œå³å¯ä»¥ä¸åœ¨åŒä¸€å±€åŸŸç½‘å†…&lt;/br&gt;
å®çº¿è¡¨ç¤ºåªèƒ½ â€œè·³è·ƒä¸€æ¬¡â€ï¼Œå³å¿…é¡»åœ¨åŒä¸€å±€åŸŸç½‘å†…&lt;/br&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;å½“è®¡ç®—æœºå‘å‡ºä¸€ä¸ªè¯·æ±‚çš„æ•°æ®åŒ…åˆ°è¾¾è´Ÿè½½å‡è¡¡å™¨åï¼Œè´Ÿè½½å‡è¡¡å™¨å°†å‘é€æ•°æ®åŒ…çš„ { ç›®æ ‡ IP åœ°å€ã€ç«¯å£å·ã€ç›®æ ‡ MAC åœ°å€ } è½¬æ¢ä¸º { æŸå°çœŸå®æœåŠ¡å™¨çš„ IP åœ°å€ã€çœŸå®æœåŠ¡çš„ç«¯å£å·ã€çœŸå®æœåŠ¡å™¨çš„ MAC åœ°å€ } ï¼Œå…¶ä½™ä¿¡æ¯ä¸å˜ã€‚è¿™ç§åªè½¬æ¢æ•°æ®åŒ…çš„ç›®æ ‡è®¾å¤‡ä¿¡æ¯ï¼Œè€Œä¸ä¿®æ”¹æ•°æ®åŒ…çš„æºè®¾å¤‡ä¿¡æ¯ï¼Œç§°ä¹‹ä¸º DNATï¼Œå³ç›®æ ‡ç½‘ç»œåœ°å€è½¬æ¢ã€‚&lt;/li&gt;
&lt;li&gt;çœŸå®æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚çš„æ•°æ®åŒ…ï¼Œè¿”å›å“åº”çš„æ•°æ®åŒ…ï¼š{ æŸå°çœŸå®æœåŠ¡å™¨çš„ IP åœ°å€ã€çœŸå®æœåŠ¡çš„ç«¯å£å·ã€çœŸå®æœåŠ¡å™¨çš„ MAC åœ°å€ } â¡ï¸  { åŸå§‹è¯·æ±‚çš„ IP åœ°å€ã€ç«¯å£å·ã€è·³è·ƒçš„ MAC åœ°å€ } ã€‚æ‰€ä»¥æ­¤æ—¶åœ¨æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹ TCP è¿æ¥ä¸ºï¼šCIP â¡ï¸  RIPã€‚&lt;/li&gt;
&lt;li&gt;çœŸå®æœåŠ¡å™¨è¿”å›çš„æ•°æ®åŒ…çš„ â€œä¸‹ä¸€ä¸ªç›®çš„åœ°â€ å¿…é¡»æ˜¯è´Ÿè½½å‡è¡¡å™¨ã€‚å¦‚æœè¿”å›æ•°æ®åŒ…ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å‘ç°è¿”å›æ•°æ®åŒ…çš„æºè®¾å¤‡ä¿¡æ¯å’Œå‘å‡ºæ•°æ®åŒ…çš„ç›®æ ‡è®¾å¤‡ä¿¡æ¯ä¸ä¸€è‡´ï¼Œå°†ä¼šä¸¢å¼ƒè¿”å›æ•°æ®åŒ…ã€‚æ‰€ä»¥çœŸå®æœåŠ¡å™¨çš„é»˜è®¤ç½‘å…³å¿…é¡»æ˜¯ DIPï¼Œä¿è¯è¿”å›æ•°æ®åŒ…çš„ â€œä¸‹ä¸€ä¸ªç›®çš„åœ°â€ æ˜¯è´Ÿè½½å‡è¡¡å™¨ã€‚&lt;/li&gt;
&lt;li&gt;å½“è¿”å›çš„æ•°æ®åŒ…åˆ°è¾¾è´Ÿè½½å‡è¡¡å™¨åï¼Œè´Ÿè½½å‡è¡¡å™¨å°†è¿”å›æ•°æ®åŒ…çš„ { åŸå§‹è¯·æ±‚çš„ IP åœ°å€ã€ç«¯å£å·ã€è·³è·ƒçš„ MAC åœ°å€ }  è½¬æ¢ä¸ºåŸå§‹è¯·æ±‚çš„ { ç›®æ ‡ IP åœ°å€ã€ç«¯å£å·ã€ç›®æ ‡ MAC åœ°å€ } ã€‚è¿™ç§åªè½¬æ¢æ•°æ®åŒ…çš„æºè®¾å¤‡ä¿¡æ¯ï¼Œè€Œä¸ä¿®æ”¹æ•°æ®åŒ…çš„ç›®æ ‡è®¾å¤‡ä¿¡æ¯ï¼Œç§°ä¹‹ä¸º SNATï¼Œå³æºç½‘ç»œåœ°å€è½¬æ¢ã€‚&lt;/li&gt;
&lt;li&gt;è´Ÿè½½å‡è¡¡å™¨è¿”å›æ•°æ®åŒ…ç»™å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€»ç»“ä¸€ä¸‹ NAT æ¨¡å¼çš„ç‰¹ç‚¹ï¼š&lt;/strong&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œæº IP åœ°å€ã€æˆ– ã€Œç›®æ ‡ IP åœ°å€ã€ï¼Œå¯ä»¥å¯¹ç«¯å£è¿›è¡Œè½¬å‘&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çœŸå®æœåŠ¡å™¨çš„é»˜è®¤ç½‘å…³å¿…é¡»æ˜¯è´Ÿè½½å‡è¡¡å™¨ï¼Œæ‰€ä»¥çœŸå®æœåŠ¡å™¨å’Œè´Ÿè½½å‡è¡¡å™¨å¿…é¡»åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰€æœ‰çš„è¯·æ±‚æ•°æ®åŒ…ã€å“åº”æ•°æ®åŒ…éƒ½è¦ç»è¿‡è´Ÿè½½å‡è¡¡å™¨&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;fullnat-æ¨¡å¼&#34;&gt;FULLNAT æ¨¡å¼&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;NAT æ¨¡å¼ä¸­ï¼Œè´Ÿè½½å‡è¡¡å™¨å’ŒçœŸå®æœåŠ¡å™¨å¿…é¡»åœ¨åŒä¸€å±€åŸŸç½‘å†…ï¼Œä½†åœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒçœŸå®æœåŠ¡å™¨å¯èƒ½åˆ†å¸ƒåœ¨ä¸åŒçš„ç½‘æ®µï¼Œç”šè‡³ä¸åŒçš„åŸå¸‚ã€‚å¦‚ä½•èƒ½å°† NAT æ¨¡å¼åº”ç”¨åœ¨çœŸå®æœåŠ¡å™¨åˆ†å¸ƒåœ¨ä¸åŒç½‘æ®µçš„åœºæ™¯ä¸‹ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_3.svg&#34; &gt;
		&lt;img src=&#34;https://boxtsecond.github.io/zh-cn/dev/lb4/img/lb4_3.svg&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;FULLNAT&#34;
			width=&#34;85%&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;FULLNAT&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;çº¢è‰²è¡¨ç¤ºå‘å‡ºçš„æ•°æ®åŒ…&lt;/br&gt;
ç»¿è‰²è¡¨ç¤ºè¿”å›çš„æ•°æ®åŒ…&lt;/br&gt;
é»„è‰²è¡¨ç¤ºè´Ÿè½½å‡è¡¡å™¨ä¿®æ”¹çš„å†…å®¹&lt;/br&gt;
è™šçº¿è¡¨ç¤ºç»è¿‡ N ä¸ªä¸‹ä¸€è·³ï¼Œå³å¯ä»¥ä¸åœ¨åŒä¸€å±€åŸŸç½‘å†…&lt;/br&gt;
å®çº¿è¡¨ç¤ºåªèƒ½ â€œè·³è·ƒä¸€æ¬¡â€ï¼Œå³å¿…é¡»åœ¨åŒä¸€å±€åŸŸç½‘&lt;/br&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;å½“è®¡ç®—æœºå‘å‡ºä¸€ä¸ªè¯·æ±‚çš„æ•°æ®åŒ…åˆ°è¾¾è´Ÿè½½å‡è¡¡å™¨åï¼Œè´Ÿè½½å‡è¡¡å™¨ä¼šå¯¹è¯·æ±‚æ•°æ®åŒ…åŒæ—¶åš SNAT å’Œ DNATï¼Œå°†è¯·æ±‚æ•°æ®åŒ…ä¿®æ”¹ä¸ºï¼š{ å‡è¡¡å‡ºå£ IP åœ°å€ã€ç«¯å£å·ã€è´Ÿè½½å‡è¡¡å™¨çš„ MAC åœ°å€ } â¡ï¸  { æŸå°çœŸå®æœåŠ¡å™¨çš„ IP åœ°å€ã€çœŸå®æœåŠ¡çš„ç«¯å£å·ã€çœŸå®æœåŠ¡å™¨çš„ MAC åœ°å€ }ã€‚&lt;/li&gt;
&lt;li&gt;è¿™æ ·è´Ÿè½½å‡è¡¡å™¨å°±å¯ä»¥ç‹¬ç«‹çš„å’ŒçœŸå®æœåŠ¡å™¨è¿›è¡Œæ•°æ®åŒ…çš„ä¼ é€&lt;/li&gt;
&lt;li&gt;çœŸå®æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚çš„æ•°æ®åŒ…ï¼Œè¿”å›å“åº”çš„æ•°æ®åŒ…ï¼š{ æŸå°çœŸå®æœåŠ¡å™¨çš„ IP åœ°å€ã€çœŸå®æœåŠ¡çš„ç«¯å£å·ã€çœŸå®æœåŠ¡å™¨çš„ MAC åœ°å€ } â¡ï¸  { è´Ÿè½½å‡è¡¡å™¨çš„ IP åœ°å€ã€ç«¯å£å·ã€è´Ÿè½½å‡è¡¡å™¨çš„ MAC åœ°å€ } ã€‚æ­¤æ—¶åœ¨çœŸå®æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹ TCP è¿æ¥ä¸ºï¼šDIP â¡ï¸  RIPã€‚&lt;/li&gt;
&lt;li&gt;å½“è¿”å›çš„æ•°æ®åŒ…åˆ°è¾¾è´Ÿè½½å‡è¡¡å™¨åï¼Œè´Ÿè½½å‡è¡¡å™¨å°†è¿”å›æ•°æ®åŒ…å†æ¬¡åŒæ—¶åš DNAT å’Œ SNATã€‚&lt;/li&gt;
&lt;li&gt;è´Ÿè½½å‡è¡¡å™¨è¿”å›æ•°æ®åŒ…ç»™å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€»ç»“ä¸€ä¸‹FULL NAT æ¨¡å¼çš„ç‰¹ç‚¹ï¼š&lt;/strong&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŒæ—¶ä¿®æ”¹æ•°æ®åŒ…çš„ã€Œæº IP åœ°å€ã€å’Œã€Œç›®æ ‡ IP åœ°å€ã€ï¼Œå¯ä»¥å¯¹ç«¯å£è¿›è¡Œè½¬å‘&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è´Ÿè½½å‡è¡¡å™¨ä¸éœ€è¦ä»¥ç½‘å…³çš„å½¢å¼å­˜åœ¨ï¼Œå³è´Ÿè½½å‡è¡¡å™¨å¯ä»¥å’ŒçœŸå®æœåŠ¡å™¨åœ¨ä¸åŒçš„ç½‘ç»œä¸­&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çœŸå®æœåŠ¡å™¨æœ€ç»ˆå»ºç«‹çš„è¿æ¥æ˜¯ DIP â¡ï¸  RIPï¼Œæ— æ³•è·å–çœŸå®å®¢æˆ·ç«¯çš„ IP åœ°å€&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰€æœ‰çš„è¯·æ±‚æ•°æ®åŒ…ã€å“åº”æ•°æ®åŒ…éƒ½è¦ç»è¿‡è´Ÿè½½å‡è¡¡å™¨&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;LVS æœ¬èº«ä¸æ”¯æŒ FULLNAT æ¨¡å¼ï¼Œéœ€è¦é¢å¤–å¯¹å†…æ ¸æ‰“è¡¥ä¸åæ‰èƒ½ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°åœ¨ NAT å’Œ FULLNAT æ¨¡å¼ä¸­ï¼Œä¸ç®¡æ˜¯è¯·æ±‚æ•°æ®åŒ…è¿˜æ˜¯å“åº”æ•°æ®åŒ…ï¼Œéƒ½è¦ç»è¿‡è´Ÿè½½å‡è¡¡å™¨ã€‚ä½†æ˜¯å“åº”æ•°æ®åŒ…ä¸€èˆ¬è¦æ¯”è¯·æ±‚æ•°æ®åŒ…å¤§å¾ˆå¤šï¼Œè¿™å¯èƒ½ä¼šæˆä¸ºç³»ç»Ÿçš„ç“¶é¢ˆã€‚å¦‚æœèƒ½å¤Ÿå°†è¯·æ±‚æ•°æ®åŒ…è½¬å‘åˆ°çœŸå®æœåŠ¡å™¨ä¹‹åï¼Œå“åº”æ•°æ®åŒ…ç”±çœŸå®æœåŠ¡å™¨ç›´æ¥è¿”å›ï¼Œè¿™æ ·å¯¹è´Ÿè½½å‡è¡¡å™¨çš„å‹åŠ›å°±å°å¾ˆå¤šã€‚è¿™ç§æ¨¡å¼åˆè¯¥å¦‚ä½•å®ç°ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸‹ç¯‡ç»§ç»­ï½&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
